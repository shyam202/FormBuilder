{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.logout = exports.setUser = exports.initAuth = undefined;\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _Formio = require('formiojs/Formio');\n\nvar _Formio2 = _interopRequireDefault(_Formio);\n\nvar _constants = require('./constants');\n\nvar type = _interopRequireWildcard(_constants);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar requestUser = function requestUser() {\n  return {\n    type: type.USER_REQUEST\n  };\n};\n\nvar receiveUser = function receiveUser(user) {\n  return {\n    type: type.USER_REQUEST_SUCCESS,\n    user: user\n  };\n};\n\nvar failUser = function failUser(error) {\n  return {\n    type: type.USER_REQUEST_FAILURE,\n    error: error\n  };\n};\n\nvar logoutUser = function logoutUser() {\n  return {\n    type: type.USER_LOGOUT\n  };\n};\n\nvar submissionAccessUser = function submissionAccessUser(submissionAccess) {\n  return {\n    type: type.USER_SUBMISSION_ACCESS,\n    submissionAccess: submissionAccess\n  };\n};\n\nvar formAccessUser = function formAccessUser(formAccess) {\n  return {\n    type: type.USER_FORM_ACCESS,\n    formAccess: formAccess\n  };\n};\n\nvar projectAccessUser = function projectAccessUser(projectAccess) {\n  return {\n    type: type.USER_PROJECT_ACCESS,\n    projectAccess: projectAccess\n  };\n};\n\nvar rolesUser = function rolesUser(roles) {\n  return {\n    type: type.USER_ROLES,\n    roles: roles\n  };\n};\n\nfunction transformSubmissionAccess(forms) {\n  return Object.values(forms).reduce(function (result, form) {\n    return _extends({}, result, _defineProperty({}, form.name, form.submissionAccess.reduce(function (formSubmissionAccess, access) {\n      return _extends({}, formSubmissionAccess, _defineProperty({}, access.type, access.roles));\n    }, {})));\n  }, {});\n}\n\nfunction transformFormAccess(forms) {\n  return Object.values(forms).reduce(function (result, form) {\n    return _extends({}, result, _defineProperty({}, form.name, form.access.reduce(function (formAccess, access) {\n      return _extends({}, formAccess, _defineProperty({}, access.type, access.roles));\n    }, {})));\n  }, {});\n}\n\nfunction transformProjectAccess(projectAccess) {\n  return projectAccess.reduce(function (result, access) {\n    return _extends({}, result, _defineProperty({}, access.type, access.roles));\n  }, {});\n}\n\nvar initAuth = exports.initAuth = function initAuth() {\n  return function (dispatch) {\n    var projectUrl = _Formio2.default.getProjectUrl();\n\n    dispatch(requestUser());\n    Promise.all([_Formio2.default.currentUser(), _Formio2.default.makeStaticRequest(projectUrl + '/access').then(function (result) {\n      var submissionAccess = transformSubmissionAccess(result.forms);\n      var formAccess = transformFormAccess(result.forms);\n      dispatch(submissionAccessUser(submissionAccess));\n      dispatch(formAccessUser(formAccess));\n      dispatch(rolesUser(result.roles));\n    }).catch(function () {}), _Formio2.default.makeStaticRequest(projectUrl).then(function (project) {\n      var projectAccess = transformProjectAccess(project.access);\n      dispatch(projectAccessUser(projectAccess));\n    }).catch(function () {})]).then(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 1),\n          user = _ref2[0];\n\n      if (user) {\n        dispatch(receiveUser(user));\n      } else {\n        dispatch(logoutUser());\n      }\n    }).catch(function (result) {\n      dispatch(failUser(result));\n    });\n  };\n};\n\nvar setUser = exports.setUser = function setUser(user) {\n  return function (dispatch) {\n    _Formio2.default.setUser(user);\n\n    dispatch(receiveUser(user));\n  };\n};\n\nvar logout = exports.logout = function logout() {\n  return function (dispatch) {\n    _Formio2.default.logout();\n\n    dispatch(logoutUser());\n  };\n};","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/react-formio/lib/modules/auth/actions.js"],"names":["Object","defineProperty","exports","value","logout","setUser","initAuth","undefined","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","_extends","assign","target","arguments","source","key","prototype","hasOwnProperty","call","_Formio","require","_Formio2","_interopRequireDefault","_constants","type","_interopRequireWildcard","obj","__esModule","newObj","default","_defineProperty","enumerable","configurable","writable","requestUser","USER_REQUEST","receiveUser","user","USER_REQUEST_SUCCESS","failUser","error","USER_REQUEST_FAILURE","logoutUser","USER_LOGOUT","submissionAccessUser","submissionAccess","USER_SUBMISSION_ACCESS","formAccessUser","formAccess","USER_FORM_ACCESS","projectAccessUser","projectAccess","USER_PROJECT_ACCESS","rolesUser","roles","USER_ROLES","transformSubmissionAccess","forms","values","reduce","result","form","name","formSubmissionAccess","access","transformFormAccess","transformProjectAccess","dispatch","projectUrl","getProjectUrl","Promise","all","currentUser","makeStaticRequest","then","catch","project","_ref","_ref2"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.logout = exports.setUser = exports.initAuth = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _Formio = require('formiojs/Formio');\n\nvar _Formio2 = _interopRequireDefault(_Formio);\n\nvar _constants = require('./constants');\n\nvar type = _interopRequireWildcard(_constants);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar requestUser = function requestUser() {\n  return {\n    type: type.USER_REQUEST\n  };\n};\n\nvar receiveUser = function receiveUser(user) {\n  return {\n    type: type.USER_REQUEST_SUCCESS,\n    user: user\n  };\n};\n\nvar failUser = function failUser(error) {\n  return {\n    type: type.USER_REQUEST_FAILURE,\n    error: error\n  };\n};\n\nvar logoutUser = function logoutUser() {\n  return {\n    type: type.USER_LOGOUT\n  };\n};\n\nvar submissionAccessUser = function submissionAccessUser(submissionAccess) {\n  return {\n    type: type.USER_SUBMISSION_ACCESS,\n    submissionAccess: submissionAccess\n  };\n};\n\nvar formAccessUser = function formAccessUser(formAccess) {\n  return {\n    type: type.USER_FORM_ACCESS,\n    formAccess: formAccess\n  };\n};\n\nvar projectAccessUser = function projectAccessUser(projectAccess) {\n  return {\n    type: type.USER_PROJECT_ACCESS,\n    projectAccess: projectAccess\n  };\n};\n\nvar rolesUser = function rolesUser(roles) {\n  return {\n    type: type.USER_ROLES,\n    roles: roles\n  };\n};\n\nfunction transformSubmissionAccess(forms) {\n  return Object.values(forms).reduce(function (result, form) {\n    return _extends({}, result, _defineProperty({}, form.name, form.submissionAccess.reduce(function (formSubmissionAccess, access) {\n      return _extends({}, formSubmissionAccess, _defineProperty({}, access.type, access.roles));\n    }, {})));\n  }, {});\n}\n\nfunction transformFormAccess(forms) {\n  return Object.values(forms).reduce(function (result, form) {\n    return _extends({}, result, _defineProperty({}, form.name, form.access.reduce(function (formAccess, access) {\n      return _extends({}, formAccess, _defineProperty({}, access.type, access.roles));\n    }, {})));\n  }, {});\n}\n\nfunction transformProjectAccess(projectAccess) {\n  return projectAccess.reduce(function (result, access) {\n    return _extends({}, result, _defineProperty({}, access.type, access.roles));\n  }, {});\n}\n\nvar initAuth = exports.initAuth = function initAuth() {\n  return function (dispatch) {\n    var projectUrl = _Formio2.default.getProjectUrl();\n\n    dispatch(requestUser());\n\n    Promise.all([_Formio2.default.currentUser(), _Formio2.default.makeStaticRequest(projectUrl + '/access').then(function (result) {\n      var submissionAccess = transformSubmissionAccess(result.forms);\n      var formAccess = transformFormAccess(result.forms);\n\n      dispatch(submissionAccessUser(submissionAccess));\n      dispatch(formAccessUser(formAccess));\n      dispatch(rolesUser(result.roles));\n    }).catch(function () {}), _Formio2.default.makeStaticRequest(projectUrl).then(function (project) {\n      var projectAccess = transformProjectAccess(project.access);\n      dispatch(projectAccessUser(projectAccess));\n    }).catch(function () {})]).then(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 1),\n          user = _ref2[0];\n\n      if (user) {\n        dispatch(receiveUser(user));\n      } else {\n        dispatch(logoutUser());\n      }\n    }).catch(function (result) {\n      dispatch(failUser(result));\n    });\n  };\n};\n\nvar setUser = exports.setUser = function setUser(user) {\n  return function (dispatch) {\n    _Formio2.default.setUser(user);\n    dispatch(receiveUser(user));\n  };\n};\n\nvar logout = exports.logout = function logout() {\n  return function (dispatch) {\n    _Formio2.default.logout();\n    dispatch(logoutUser());\n  };\n};"]},"metadata":{},"sourceType":"script"}