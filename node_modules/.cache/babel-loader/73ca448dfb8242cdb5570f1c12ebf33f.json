{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Webform2 = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Formio = _interopRequireDefault(require(\"./Formio\"));\n\nvar _utils = require(\"./utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar Wizard = /*#__PURE__*/function (_Webform) {\n  _inherits(Wizard, _Webform);\n\n  var _super = _createSuper(Wizard);\n  /**\n   * Constructor for wizard based forms\n   * @param element Dom element to place this wizard.\n   * @param {Object} options Options object, supported options are:\n   *    - breadcrumbSettings.clickable: true (default) determines if the breadcrumb bar is clickable or not\n   *    - buttonSettings.show*(Previous, Next, Cancel): true (default) determines if the button is shown or not\n   *    - allowPrevious: false (default) determines if the breadcrumb bar is clickable or not for visited tabs\n   */\n\n\n  function Wizard() {\n    var _this;\n\n    _classCallCheck(this, Wizard);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    }\n\n    _this = _super.call(this, element, options);\n    _this.pages = [];\n    _this.prefixComps = [];\n    _this.suffixComps = [];\n    _this.components = [];\n    _this.originalComponents = [];\n    _this.page = 0;\n    _this.currentPanel = null;\n    _this.currentPanels = null;\n    _this.currentNextPage = 0;\n    _this._seenPages = [0];\n    _this.subWizards = [];\n    _this.allPages = [];\n    _this.lastPromise = _nativePromiseOnly.default.resolve();\n    _this.enabledIndex = 0;\n    _this.editMode = false;\n    _this.originalOptions = _lodash.default.cloneDeep(_this.options);\n    return _this;\n  }\n\n  _createClass(Wizard, [{\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      var next = this.getNextPage();\n\n      if (_lodash.default.isNumber(next)) {\n        return next === -1;\n      }\n\n      return _lodash.default.isNull(next);\n    }\n  }, {\n    key: \"getPages\",\n    value: function getPages() {\n      var _this2 = this;\n\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _args$all = args.all,\n          all = _args$all === void 0 ? false : _args$all;\n      var pages = this.hasExtraPages ? this.components : this.pages;\n      var filteredPages = pages.filter(all ? _lodash.default.identity : function (p, index) {\n        return _this2._seenPages.includes(index);\n      });\n      return filteredPages;\n    }\n  }, {\n    key: \"hasExtraPages\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.subWizards);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return _get(_getPrototypeOf(Wizard.prototype), \"data\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      this._data = value;\n\n      _lodash.default.each(this.getPages({\n        all: true\n      }), function (component) {\n        component.data = _this3.componentContext(component);\n      });\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      this.establishPages(data);\n      return _get(_getPrototypeOf(Wizard.prototype), \"checkConditions\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.submitting ? this.getPages({\n        all: this.isLastPage()\n      }) : _get(_getPrototypeOf(Wizard.prototype), \"getComponents\", this).call(this);\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.getPages({\n        all: true\n      }).forEach(function (page) {\n        return page.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this4 = this; // Check for and initlize button settings object\n\n\n      this.options.buttonSettings = _lodash.default.defaults(this.options.buttonSettings, {\n        showPrevious: true,\n        showNext: true,\n        showSubmit: true,\n        showCancel: !this.options.readOnly\n      });\n\n      if (!this.isSecondInit) {\n        var _this$options, _this$options$breadcr;\n\n        this.isClickableDefined = (_this$options = this.options) === null || _this$options === void 0 ? void 0 : (_this$options$breadcr = _this$options.breadcrumbSettings) === null || _this$options$breadcr === void 0 ? void 0 : _this$options$breadcr.hasOwnProperty('clickable');\n        this.isSecondInit = true;\n      }\n\n      this.options.breadcrumbSettings = _lodash.default.defaults(this.options.breadcrumbSettings, {\n        clickable: true\n      });\n      this.options.allowPrevious = this.options.allowPrevious || false;\n      this.page = 0;\n\n      var onReady = _get(_getPrototypeOf(Wizard.prototype), \"init\", this).call(this);\n\n      this.setComponentSchema();\n\n      if (this.pages && this.pages.length) {\n        this.component = this.pages[this.page].component;\n      }\n\n      this.on('subWizardsUpdated', function (subForm) {\n        var subWizard = _this4.subWizards.find(function (subWizard) {\n          var _subWizard$subForm;\n\n          return (subForm === null || subForm === void 0 ? void 0 : subForm.id) && ((_subWizard$subForm = subWizard.subForm) === null || _subWizard$subForm === void 0 ? void 0 : _subWizard$subForm.id) === (subForm === null || subForm === void 0 ? void 0 : subForm.id);\n        });\n\n        if (_this4.subWizards.length && subWizard) {\n          subWizard.subForm.setValue(subForm._submission, {}, true);\n\n          _this4.establishPages();\n\n          _this4.redraw();\n        }\n      });\n      return onReady;\n    }\n  }, {\n    key: \"wizardKey\",\n    get: function get() {\n      return \"wizard-\".concat(this.id);\n    }\n  }, {\n    key: \"wizard\",\n    get: function get() {\n      return this.form;\n    },\n    set: function set(form) {\n      this.setForm(form);\n    }\n  }, {\n    key: \"buttons\",\n    get: function get() {\n      var _this5 = this;\n\n      var buttons = {};\n      [{\n        name: 'cancel',\n        method: 'cancel'\n      }, {\n        name: 'previous',\n        method: 'prevPage'\n      }, {\n        name: 'next',\n        method: 'nextPage'\n      }, {\n        name: 'submit',\n        method: 'submit'\n      }].forEach(function (button) {\n        if (_this5.hasButton(button.name)) {\n          buttons[button.name] = button;\n        }\n      });\n      return buttons;\n    }\n  }, {\n    key: \"renderContext\",\n    get: function get() {\n      var _this$root, _this$root$component;\n\n      return {\n        wizardKey: this.wizardKey,\n        isBreadcrumbClickable: this.isBreadcrumbClickable(),\n        isSubForm: !!this.parent && !((_this$root = this.root) !== null && _this$root !== void 0 && (_this$root$component = _this$root.component) !== null && _this$root$component !== void 0 && _this$root$component.type) === 'wizard',\n        panels: this.allPages.length ? this.allPages.map(function (page) {\n          return page.component;\n        }) : this.pages.map(function (page) {\n          return page.component;\n        }),\n        buttons: this.buttons,\n        currentPage: this.page\n      };\n    }\n  }, {\n    key: \"prepareNavigationSettings\",\n    value: function prepareNavigationSettings(ctx) {\n      var currentPanel = this.currentPanel;\n\n      if (currentPanel && currentPanel.buttonSettings) {\n        Object.keys(currentPanel.buttonSettings).forEach(function () {\n          Object.keys(ctx.buttons).forEach(function (key) {\n            if (typeof currentPanel.buttonSettings[key] !== 'undefined' && !currentPanel.buttonSettings[key] || ctx.isSubForm) {\n              ctx.buttons[key] = null;\n            }\n          });\n        });\n      }\n\n      return this.renderTemplate('wizardNav', ctx);\n    }\n  }, {\n    key: \"prepareHeaderSettings\",\n    value: function prepareHeaderSettings(ctx) {\n      if (this.currentPanel && this.currentPanel.breadcrumb === 'none' || ctx.isSubForm) {\n        return null;\n      }\n\n      return this.renderTemplate('wizardHeader', ctx);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var ctx = this.renderContext;\n\n      if (this.component.key) {\n        ctx.panels.map(function (panel) {\n          if (panel.key === _this6.component.key) {\n            _this6.currentPanel = panel;\n            ctx.wizardPageTooltip = _this6.getFormattedTooltip(panel.tooltip);\n          }\n        });\n      }\n\n      var wizardNav = this.prepareNavigationSettings(ctx);\n      var wizardHeader = this.prepareHeaderSettings(ctx);\n      return this.renderTemplate('wizard', _objectSpread(_objectSpread({}, ctx), {}, {\n        className: _get(_getPrototypeOf(Wizard.prototype), \"getClassName\", this).call(this),\n        wizardHeader: wizardHeader,\n        wizardNav: wizardNav,\n        components: this.renderComponents([].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)))\n      }), this.builderMode ? 'builder' : 'form');\n    }\n  }, {\n    key: \"redrawNavigation\",\n    value: function redrawNavigation() {\n      if (this.element) {\n        var navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n\n        if (navElement) {\n          var _this$loadRefs;\n\n          this.detachNav();\n          navElement.outerHTML = this.renderTemplate('wizardNav', this.renderContext);\n          navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n          this.loadRefs(navElement, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _this$loadRefs));\n          this.attachNav();\n        }\n      }\n    }\n  }, {\n    key: \"redrawHeader\",\n    value: function redrawHeader() {\n      if (this.element) {\n        var headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n\n        if (headerElement) {\n          var _this$loadRefs2;\n\n          this.detachHeader();\n          headerElement.outerHTML = this.renderTemplate('wizardHeader', this.renderContext);\n          headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n          this.loadRefs(headerElement, (_this$loadRefs2 = {}, _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs2));\n          this.attachHeader();\n        }\n      }\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs3,\n          _this7 = this;\n\n      this.element = element;\n      this.loadRefs(element, (_this$loadRefs3 = {}, _defineProperty(_this$loadRefs3, this.wizardKey, 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs3));\n\n      if ((this.options.readOnly || this.editMode) && !this.enabledIndex) {\n        var _this$pages;\n\n        this.enabledIndex = ((_this$pages = this.pages) === null || _this$pages === void 0 ? void 0 : _this$pages.length) - 1;\n      }\n\n      var promises = this.attachComponents(this.refs[this.wizardKey], [].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)));\n      this.attachNav();\n      this.attachHeader();\n      return promises.then(function () {\n        _this7.emit('render', {\n          component: _this7.currentPage,\n          page: _this7.page\n        });\n\n        if (_this7.component.scrollToTop) {\n          _this7.scrollPageToTop();\n        }\n      });\n    }\n  }, {\n    key: \"scrollPageToTop\",\n    value: function scrollPageToTop() {\n      if (!this.refs[this.wizardKey]) {\n        return;\n      }\n\n      if ('scrollIntoView' in this.refs[this.wizardKey]) {\n        this.refs[this.wizardKey].scrollIntoView(true);\n      } else {\n        this.scrollIntoView(this.refs[this.wizardKey]);\n      }\n    }\n  }, {\n    key: \"isBreadcrumbClickable\",\n    value: function isBreadcrumbClickable() {\n      var _this8 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this8.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return this.isClickableDefined ? this.options.breadcrumbSettings.clickable : _lodash.default.get(currentPage, 'component.breadcrumbClickable', true);\n    }\n  }, {\n    key: \"isAllowPrevious\",\n    value: function isAllowPrevious() {\n      var _this9 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this9.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return _lodash.default.get(currentPage.component, 'allowPrevious', this.options.allowPrevious);\n    }\n  }, {\n    key: \"attachNav\",\n    value: function attachNav() {\n      var _this10 = this;\n\n      _lodash.default.each(this.buttons, function (button) {\n        var buttonElement = _this10.refs[\"\".concat(_this10.wizardKey, \"-\").concat(button.name)];\n\n        _this10.addEventListener(buttonElement, 'click', function (event) {\n          event.preventDefault(); // Disable the button until done.\n\n          buttonElement.setAttribute('disabled', 'disabled');\n\n          _this10.setLoading(buttonElement, true); // Call the button method, then re-enable the button.\n\n\n          _this10[button.method]().then(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          }).catch(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"emitWizardPageSelected\",\n    value: function emitWizardPageSelected(index) {\n      this.emit('wizardPageSelected', this.pages[index], index);\n    }\n  }, {\n    key: \"attachHeader\",\n    value: function attachHeader() {\n      var _this11 = this;\n\n      var isAllowPrevious = this.isAllowPrevious();\n      this.attachTooltips(this.refs[\"\".concat(this.wizardKey, \"-tooltip\")], this.currentPanel.tooltip);\n\n      if (this.isBreadcrumbClickable() || isAllowPrevious) {\n        var _this$refs$;\n\n        (_this$refs$ = this.refs[\"\".concat(this.wizardKey, \"-link\")]) === null || _this$refs$ === void 0 ? void 0 : _this$refs$.forEach(function (link, index) {\n          if (!isAllowPrevious || index <= _this11.enabledIndex) {\n            _this11.addEventListener(link, 'click', function (event) {\n              _this11.emit('wizardNavigationClicked', _this11.pages[index]);\n\n              event.preventDefault();\n              return _this11.setPage(index).then(function () {\n                _this11.emitWizardPageSelected(index);\n              });\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"detachNav\",\n    value: function detachNav() {\n      var _this12 = this;\n\n      _lodash.default.each(this.buttons, function (button) {\n        _this12.removeEventListener(_this12.refs[\"\".concat(_this12.wizardKey, \"-\").concat(button.name)], 'click');\n      });\n    }\n  }, {\n    key: \"detachHeader\",\n    value: function detachHeader() {\n      var _this13 = this;\n\n      if (this.refs[\"\".concat(this.wizardKey, \"-link\")]) {\n        this.refs[\"\".concat(this.wizardKey, \"-link\")].forEach(function (link) {\n          _this13.removeEventListener(link, 'click');\n        });\n      }\n    }\n  }, {\n    key: \"transformPages\",\n    value: function transformPages() {\n      var _this14 = this;\n\n      var allComponents = [];\n      var components = this.getSortedComponents(this);\n      var defferedComponents = [];\n      this.allPages = []; // Get all components including all nested components and line up in the correct order\n\n      var getAllComponents = function getAllComponents(nestedComp, compsArr) {\n        var pushAllowed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var nestedPages = [];\n        var dataArrayComponents = ['datagrid', 'editgrid', 'dynamicWizard'];\n        var currentComponents = nestedComp !== null && nestedComp !== void 0 && nestedComp.subForm ? _this14.getSortedComponents(nestedComp.subForm) : (nestedComp === null || nestedComp === void 0 ? void 0 : nestedComp.components) || [];\n        var visibleComponents = currentComponents.filter(function (comp) {\n          return comp._visible;\n        });\n        var filteredComponents = visibleComponents.filter(function (comp) {\n          return !dataArrayComponents.includes(comp.component.type) && (comp.type !== 'form' || comp.isNestedWizard);\n        });\n        var additionalComponents = visibleComponents.filter(function (comp) {\n          var _comp$subForm;\n\n          return ((_comp$subForm = comp.subForm) === null || _comp$subForm === void 0 ? void 0 : _comp$subForm._form.display) !== 'wizard';\n        });\n        var hasNested = false;\n        (0, _utils.eachComponent)(filteredComponents, function (comp) {\n          if (comp.component.type === 'panel' && comp !== null && comp !== void 0 && comp.parent.wizard && !getAllComponents(comp, compsArr, false)) {\n            if (pushAllowed) {\n              _this14.setRootPanelId(comp);\n\n              nestedPages.push(comp);\n            }\n\n            hasNested = true;\n          }\n\n          if (comp && comp.isNestedWizard && comp.subForm) {\n            var hasNestedForm = getAllComponents(comp, nestedPages, pushAllowed);\n\n            if (!hasNested) {\n              hasNested = hasNestedForm;\n            }\n          }\n        }, true);\n\n        if (nestedComp.component.type === 'panel') {\n          if (!hasNested && pushAllowed) {\n            _this14.setRootPanelId(nestedComp);\n\n            compsArr.push(nestedComp);\n          }\n\n          if (hasNested && additionalComponents.length) {\n            var newComp = _lodash.default.clone(nestedComp);\n\n            newComp.components = additionalComponents;\n\n            _this14.setRootPanelId(newComp);\n\n            defferedComponents.push(newComp);\n          }\n        }\n\n        if (pushAllowed) {\n          compsArr.push.apply(compsArr, _toConsumableArray(defferedComponents).concat(nestedPages));\n          defferedComponents = [];\n        }\n\n        return hasNested;\n      };\n\n      components.forEach(function (component) {\n        getAllComponents(component, allComponents);\n      }, []); // recalculate pages only for root wizards, including the situation when the wizard is in a wrapper\n\n      if (this.localRoot && this.id === this.localRoot.id) {\n        allComponents.forEach(function (comp, index) {\n          comp.eachComponent(function (component) {\n            component.page = index;\n          });\n        });\n      }\n\n      this.allPages = allComponents;\n    }\n  }, {\n    key: \"getSortedComponents\",\n    value: function getSortedComponents(_ref) {\n      var components = _ref.components,\n          originalComponents = _ref.originalComponents; // sorts components if they were shuffled after the conditional logic\n\n      var currentComponents = [];\n      var currentPages = [];\n\n      if (components && components.length) {\n        components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      originalComponents === null || originalComponents === void 0 ? void 0 : originalComponents.forEach(function (item) {\n        if (!item.key) {\n          item.key = item.title;\n        }\n\n        if (currentPages[item.key]) {\n          currentComponents.push(currentPages[item.key]);\n        }\n      });\n      return currentComponents;\n    }\n  }, {\n    key: \"findRootPanel\",\n    value: function findRootPanel(component) {\n      var _component$parent;\n\n      return (_component$parent = component.parent) !== null && _component$parent !== void 0 && _component$parent.parent ? this.findRootPanel(component.parent) : component;\n    }\n  }, {\n    key: \"setRootPanelId\",\n    value: function setRootPanelId(component) {\n      var _component$parent2;\n\n      if (component.rootPanelId && component.rootPanelId !== component.id) {\n        return;\n      }\n\n      var parent = (_component$parent2 = component.parent) !== null && _component$parent2 !== void 0 && _component$parent2.parent ? this.findRootPanel(component.parent) : component;\n      component.rootPanelId = parent.id;\n    }\n  }, {\n    key: \"establishPages\",\n    value: function establishPages() {\n      var _this15 = this;\n\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.data;\n      this.pages = [];\n      this.prefixComps = [];\n      this.suffixComps = [];\n      var visible = [];\n      var currentPages = {};\n\n      var pageOptions = _lodash.default.clone(this.options);\n\n      if (this.components && this.components.length) {\n        this.components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      if (this.originalComponents) {\n        this.originalComponents.forEach(function (item) {\n          if (item.type === 'panel') {\n            if (!item.key) {\n              item.key = item.title;\n            }\n\n            var page = currentPages[item.key];\n            var forceShow = _this15.options.show ? _this15.options.show[item.key] : false;\n            var forceHide = _this15.options.hide ? _this15.options.hide[item.key] : false;\n            var isVisible = (0, _utils.checkCondition)(item, data, data, _this15.component, _this15) && !item.hidden;\n\n            if (forceShow) {\n              isVisible = true;\n            } else if (forceHide) {\n              isVisible = false;\n            }\n\n            if (isVisible) {\n              visible.push(item);\n\n              if (page) {\n                _this15.pages.push(page);\n              }\n            }\n\n            if (!page && isVisible) {\n              page = _this15.createComponent(item, pageOptions);\n              page.visible = isVisible;\n\n              _this15.pages.push(page);\n\n              page.eachComponent(function (component) {\n                component.page = _this15.pages.length - 1;\n              });\n            } else if (page && !isVisible) {\n              _this15.removeComponent(page);\n            }\n          } else if (item.type !== 'button') {\n            if (!_this15.pages.length) {\n              _this15.prefixComps.push(_this15.createComponent(item, pageOptions));\n            } else {\n              _this15.suffixComps.push(_this15.createComponent(item, pageOptions));\n            }\n          }\n        });\n      }\n\n      if (this.pages.length) {\n        this.emit('pagesChanged');\n      }\n\n      this.transformPages();\n\n      if (this.allPages && this.allPages.length) {\n        this.updatePages();\n      }\n\n      return visible;\n    }\n  }, {\n    key: \"updatePages\",\n    value: function updatePages() {\n      this.pages = this.allPages;\n    }\n  }, {\n    key: \"addComponents\",\n    value: function addComponents() {\n      this.establishPages();\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(num) {\n      var _this16 = this;\n\n      if (num === this.page) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (num >= 0 && num < this.pages.length) {\n        this.page = num;\n        this.pageFieldLogic(num);\n        this.getNextPage();\n        var parentNum = num;\n\n        if (this.hasExtraPages) {\n          var pageFromPages = this.pages[num];\n          var pageFromComponents = this.components[num];\n\n          if (!pageFromComponents || pageFromPages.id !== pageFromComponents.id) {\n            parentNum = this.components.findIndex(function (comp) {\n              return comp.id === _this16.pages[parentNum].rootPanelId;\n            });\n          }\n        }\n\n        if (!this._seenPages.includes(parentNum)) {\n          this._seenPages = this._seenPages.concat(parentNum);\n        }\n\n        this.redraw().then(function () {\n          _this16.checkData(_this16.submission.data);\n        });\n        return _nativePromiseOnly.default.resolve();\n      } else if (!this.pages.length) {\n        this.redraw();\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      return _nativePromiseOnly.default.reject('Page not found');\n    }\n  }, {\n    key: \"pageFieldLogic\",\n    value: function pageFieldLogic(page) {\n      // Handle field logic on pages.\n      this.component = this.pages[page].component;\n      this.originalComponent = (0, _utils.fastCloneDeep)(this.component);\n      this.fieldLogic(this.data); // If disabled changed, be sure to distribute the setting.\n\n      this.disabled = this.shouldDisabled;\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      return this.pages && this.pages.length >= this.page ? this.pages[this.page] : {\n        components: []\n      };\n    }\n  }, {\n    key: \"getNextPage\",\n    value: function getNextPage() {\n      var data = this.submission.data;\n      var form = this.pages[this.page].component; // Check conditional nextPage\n\n      if (form) {\n        var page = this.pages.length > this.page + 1 && !this.showAllErrors ? this.page + 1 : -1;\n\n        if (form.nextPage) {\n          var next = this.evaluate(form.nextPage, {\n            next: page,\n            data: data,\n            page: page,\n            form: form\n          }, 'next');\n\n          if (next === null) {\n            this.currentNextPage = null;\n            return null;\n          }\n\n          var pageNum = parseInt(next, 10);\n\n          if (!isNaN(parseInt(pageNum, 10)) && isFinite(pageNum)) {\n            this.currentNextPage = pageNum;\n            return pageNum;\n          }\n\n          this.currentNextPage = this.getPageIndexByKey(next);\n          return this.currentNextPage;\n        }\n\n        this.currentNextPage = page;\n        return page;\n      }\n\n      this.currentNextPage = null;\n      return null;\n    }\n  }, {\n    key: \"getPreviousPage\",\n    value: function getPreviousPage() {\n      return this.page - 1;\n    }\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var pages = this.getPages();\n      return _nativePromiseOnly.default.all(pages.map(function (page) {\n        page.options.beforeSubmit = true;\n        return page.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this17 = this;\n\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this17.hook(next ? 'beforeNext' : 'beforePrev', _this17.currentPage, _this17.submission, function (err) {\n          if (err) {\n            _this17.showErrors(err, true);\n\n            reject(err);\n          }\n\n          var form = _this17.currentPage;\n\n          if (form) {\n            form.beforePage(next).then(resolve).catch(reject);\n          } else {\n            resolve();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"emitNextPage\",\n    value: function emitNextPage() {\n      this.emit('nextPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"nextPage\",\n    value: function nextPage() {\n      var _this18 = this; // Read-only forms should not worry about validation before going to next page, nor should they submit.\n\n\n      if (this.options.readOnly) {\n        return this.setPage(this.getNextPage()).then(function () {\n          _this18.emit('nextPage', {\n            page: _this18.page,\n            submission: _this18.submission\n          });\n        });\n      } // Validate the form, before go to the next page\n\n\n      if (this.checkValidity(this.submission.data, true, this.submission.data, true)) {\n        this.checkData(this.submission.data);\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            if (!(_this18.options.readOnly || _this18.editMode) && _this18.enabledIndex < _this18.page) {\n              _this18.enabledIndex = _this18.page;\n\n              _this18.redraw();\n            }\n\n            _this18.emitNextPage();\n          });\n        });\n      } else {\n        this.currentPage.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n        return _nativePromiseOnly.default.reject(this.showErrors([], true));\n      }\n    }\n  }, {\n    key: \"emitPrevPage\",\n    value: function emitPrevPage() {\n      this.emit('prevPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"prevPage\",\n    value: function prevPage() {\n      var _this19 = this;\n\n      return this.beforePage().then(function () {\n        return _this19.setPage(_this19.getPreviousPage()).then(function () {\n          _this19.emitPrevPage();\n        });\n      });\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var _this20 = this;\n\n      if (this.options.readOnly) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (_get(_getPrototypeOf(Wizard.prototype), \"cancel\", this).call(this, noconfirm)) {\n        this.setPristine(true);\n        return this.setPage(0).then(function () {\n          if (_this20.enabledIndex) {\n            _this20.enabledIndex = 0;\n          }\n\n          _this20.onChange();\n\n          _this20.redraw();\n\n          return _this20.page;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"getPageIndexByKey\",\n    value: function getPageIndexByKey(key) {\n      var pageIndex = this.page;\n      this.pages.forEach(function (page, index) {\n        if (page.component.key === key) {\n          pageIndex = index;\n          return false;\n        }\n      });\n      return pageIndex;\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.wizard;\n    }\n  }, {\n    key: \"setComponentSchema\",\n    value: function setComponentSchema() {\n      var _this21 = this;\n\n      var pageKeys = {};\n      this.originalComponents = [];\n      this.component.components.map(function (item) {\n        if (item.type === 'panel') {\n          item.key = (0, _utils.uniqueKey)(pageKeys, item.key || 'panel');\n          pageKeys[item.key] = true;\n\n          if (_this21.wizard.full) {\n            _this21.options.show = _this21.options.show || {};\n            _this21.options.show[item.key] = true;\n          } else if (_this21.wizard.hasOwnProperty('full') && !_lodash.default.isEqual(_this21.originalOptions.show, _this21.options.show)) {\n            _this21.options.show = _objectSpread({}, _this21.originalOptions.show || {});\n          }\n        }\n\n        _this21.originalComponents.push(_lodash.default.clone(item));\n      });\n\n      if (!Object.keys(pageKeys).length) {\n        var newPage = {\n          type: 'panel',\n          title: 'Page 1',\n          label: 'Page 1',\n          key: 'page1',\n          components: this.component.components\n        };\n        this.component.components = [newPage];\n        this.originalComponents.push(_lodash.default.clone(newPage));\n      }\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      if (!form) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"setForm\", this).call(this, form, flags);\n    }\n  }, {\n    key: \"onSetForm\",\n    value: function onSetForm(clonedForm, initialForm) {\n      this.component.components = (this._parentPath ? initialForm.components : clonedForm.components) || [];\n      this.setComponentSchema();\n    }\n  }, {\n    key: \"setEditMode\",\n    value: function setEditMode(submission) {\n      if (!this.editMode && submission._id && !this.options.readOnly) {\n        this.editMode = true;\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this22 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var ignoreEstablishment = arguments.length > 2 ? arguments[2] : undefined;\n      this._submission = submission;\n\n      if (flags && flags.fromSubmission && (this.options.readOnly || this.editMode) && !this.isHtmlRenderMode()) {\n        this._data = submission.data;\n      }\n\n      if (!ignoreEstablishment) {\n        this.establishPages(submission.data);\n      }\n\n      var changed = this.getPages({\n        all: true\n      }).reduce(function (changed, page) {\n        return _this22.setNestedValue(page, submission.data, flags, changed) || changed;\n      }, false);\n      this.pageFieldLogic(this.page);\n      this.setEditMode(submission);\n      return changed;\n    }\n  }, {\n    key: \"isClickable\",\n    value: function isClickable(page, index) {\n      return this.page !== index && (0, _utils.firstNonNil)([_lodash.default.get(page, 'breadcrumbClickable'), this.options.breadcrumbSettings.clickable]);\n    }\n  }, {\n    key: \"hasButton\",\n    value: function hasButton(name) {\n      var nextPage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getNextPage(); // get page options with global options as default values\n\n      var _$get = _lodash.default.get(this.currentPage, 'component.buttonSettings', {}),\n          _$get$previous = _$get.previous,\n          previous = _$get$previous === void 0 ? this.options.buttonSettings.showPrevious : _$get$previous,\n          _$get$cancel = _$get.cancel,\n          cancel = _$get$cancel === void 0 ? this.options.buttonSettings.showCancel : _$get$cancel,\n          _$get$submit = _$get.submit,\n          submit = _$get$submit === void 0 ? this.options.buttonSettings.showSubmit : _$get$submit,\n          _$get$next = _$get.next,\n          next = _$get$next === void 0 ? this.options.buttonSettings.showNext : _$get$next;\n\n      switch (name) {\n        case 'previous':\n          return previous && this.getPreviousPage() > -1;\n\n        case 'next':\n          return next && nextPage !== null && nextPage !== -1;\n\n        case 'cancel':\n          return cancel && !this.options.readOnly;\n\n        case 'submit':\n          return submit && !this.options.readOnly && (nextPage === null || this.page === this.pages.length - 1);\n\n        default:\n          return true;\n      }\n    }\n  }, {\n    key: \"pageId\",\n    value: function pageId(page) {\n      if (page.key) {\n        // Some panels have the same key....\n        return \"\".concat(page.key, \"-\").concat(page.title);\n      } else if (page.components && page.components.length > 0) {\n        return this.pageId(page.components[0]);\n      } else {\n        return page.title;\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      var _this23 = this;\n\n      _get(_getPrototypeOf(Wizard.prototype), \"onChange\", this).call(this, flags, changed, modified, changes);\n\n      if (this.alert && !this.submitted) {\n        this.checkValidity(this.submission.data, false, this.submission.data, true);\n        this.showErrors([], true, true);\n      } // If the pages change, need to redraw the header.\n\n\n      var currentPanels;\n      var panels;\n      var currentNextPage = this.currentNextPage;\n\n      if (this.hasExtraPages) {\n        currentPanels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n        this.establishPages();\n        panels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n      } else {\n        currentPanels = this.currentPanels || this.pages.map(function (page) {\n          return page.component.key;\n        });\n        panels = this.establishPages().map(function (panel) {\n          return panel.key;\n        });\n        this.currentPanels = panels;\n\n        if (this.currentPanel && this.currentPanel.key) {\n          this.setPage(this.currentPanels.findIndex(function (panel) {\n            return panel === _this23.currentPanel.key;\n          }));\n        }\n      }\n\n      if (!_lodash.default.isEqual(panels, currentPanels) || flags && flags.fromSubmission) {\n        this.redrawHeader();\n      } // If the next page changes, then make sure to redraw navigation.\n\n\n      if (currentNextPage !== this.getNextPage()) {\n        this.redrawNavigation();\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      var _this$parent, _this$parent$componen;\n\n      if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n        return this.parent.redraw();\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"redraw\", this).call(this);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, currentPageOnly) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var components = !currentPageOnly || this.isLastPage() ? this.getComponents() : this.currentPage.components;\n      return components.reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row) && check;\n      }, true);\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      if (!this.isLastPage()) {\n        return this.currentPage.errors;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"errors\", this);\n    }\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      var _this24 = this;\n\n      var pageIndex = 0;\n\n      var _this$pages$filter = this.pages.filter(function (page, index) {\n        if (page.getComponent(key)) {\n          pageIndex = index;\n          return true;\n        }\n\n        return false;\n      }),\n          _this$pages$filter2 = _slicedToArray(_this$pages$filter, 1),\n          page = _this$pages$filter2[0];\n\n      if (page && page !== this.currentPage) {\n        return this.setPage(pageIndex).then(function () {\n          _this24.checkValidity(_this24.submission.data, true, _this24.submission.data);\n\n          _this24.showErrors();\n\n          _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", _this24).call(_this24, key);\n        });\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", this).call(this, key);\n    }\n  }]);\n\n  return Wizard;\n}(_Webform2.default);\n\nexports.default = Wizard;\nWizard.setBaseUrl = _Formio.default.setBaseUrl;\nWizard.setApiUrl = _Formio.default.setApiUrl;\nWizard.setAppUrl = _Formio.default.setAppUrl;","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/formiojs/Wizard.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_nativePromiseOnly","_interopRequireDefault","require","_lodash","_Webform2","_Formio","_utils","__esModule","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","_i","_arr","_n","_d","_s","_e","call","next","done","push","length","err","Array","isArray","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","toString","slice","name","from","test","iter","len","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Wizard","_Webform","_super","_this","element","options","HTMLElement","pages","prefixComps","suffixComps","components","originalComponents","page","currentPanel","currentPanels","currentNextPage","_seenPages","subWizards","allPages","lastPromise","resolve","enabledIndex","editMode","originalOptions","cloneDeep","isLastPage","getNextPage","isNumber","isNull","getPages","_this2","args","undefined","_args$all","all","hasExtraPages","filteredPages","identity","index","includes","isEmpty","set","_this3","_data","each","component","data","componentContext","checkConditions","flags","row","establishPages","getComponents","submitting","resetValue","setPristine","init","_this4","buttonSettings","defaults","showPrevious","showNext","showSubmit","showCancel","readOnly","isSecondInit","_this$options","_this$options$breadcr","isClickableDefined","breadcrumbSettings","clickable","allowPrevious","onReady","setComponentSchema","on","subForm","subWizard","find","_subWizard$subForm","id","setValue","_submission","redraw","concat","form","setForm","_this5","buttons","method","button","hasButton","_this$root","_this$root$component","wizardKey","isBreadcrumbClickable","isSubForm","parent","root","type","panels","map","currentPage","prepareNavigationSettings","ctx","renderTemplate","prepareHeaderSettings","breadcrumb","render","_this6","renderContext","panel","wizardPageTooltip","getFormattedTooltip","tooltip","wizardNav","wizardHeader","className","renderComponents","builderMode","redrawNavigation","navElement","querySelector","_this$loadRefs","detachNav","outerHTML","loadRefs","attachNav","redrawHeader","headerElement","_this$loadRefs2","detachHeader","attachHeader","attach","_this$loadRefs3","_this7","_this$pages","promises","attachComponents","refs","then","emit","scrollToTop","scrollPageToTop","scrollIntoView","_this8","isEqual","isAllowPrevious","_this9","_this10","buttonElement","addEventListener","event","preventDefault","setAttribute","setLoading","removeAttribute","catch","emitWizardPageSelected","_this11","attachTooltips","_this$refs$","link","setPage","_this12","removeEventListener","_this13","transformPages","_this14","allComponents","getSortedComponents","defferedComponents","getAllComponents","nestedComp","compsArr","pushAllowed","nestedPages","dataArrayComponents","currentComponents","visibleComponents","comp","_visible","filteredComponents","isNestedWizard","additionalComponents","_comp$subForm","_form","display","hasNested","eachComponent","wizard","setRootPanelId","hasNestedForm","newComp","clone","localRoot","_ref","currentPages","title","item","findRootPanel","_component$parent","_component$parent2","rootPanelId","_this15","visible","pageOptions","forceShow","show","forceHide","hide","isVisible","checkCondition","hidden","createComponent","removeComponent","updatePages","addComponents","num","_this16","pageFieldLogic","parentNum","pageFromPages","pageFromComponents","findIndex","checkData","submission","reject","originalComponent","fastCloneDeep","fieldLogic","disabled","shouldDisabled","showAllErrors","nextPage","evaluate","pageNum","parseInt","isNaN","isFinite","getPageIndexByKey","getPreviousPage","beforeSubmit","beforePage","_this17","hook","showErrors","emitNextPage","_this18","checkValidity","emitPrevPage","prevPage","_this19","cancel","noconfirm","_this20","onChange","pageIndex","_this21","pageKeys","uniqueKey","full","newPage","label","onSetForm","clonedForm","initialForm","_parentPath","setEditMode","_id","_this22","ignoreEstablishment","fromSubmission","isHtmlRenderMode","changed","reduce","setNestedValue","isClickable","firstNonNil","_$get","_$get$previous","previous","_$get$cancel","_$get$submit","submit","_$get$next","pageId","modified","changes","_this23","alert","submitted","_this$parent","_this$parent$componen","modalEdit","dirty","currentPageOnly","setCustomValidity","check","errors","focusOnComponent","_this24","_this$pages$filter","getComponent","_this$pages$filter2","setBaseUrl","setApiUrl","setAppUrl"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Webform2 = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Formio = _interopRequireDefault(require(\"./Formio\"));\n\nvar _utils = require(\"./utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Wizard = /*#__PURE__*/function (_Webform) {\n  _inherits(Wizard, _Webform);\n\n  var _super = _createSuper(Wizard);\n\n  /**\n   * Constructor for wizard based forms\n   * @param element Dom element to place this wizard.\n   * @param {Object} options Options object, supported options are:\n   *    - breadcrumbSettings.clickable: true (default) determines if the breadcrumb bar is clickable or not\n   *    - buttonSettings.show*(Previous, Next, Cancel): true (default) determines if the button is shown or not\n   *    - allowPrevious: false (default) determines if the breadcrumb bar is clickable or not for visited tabs\n   */\n  function Wizard() {\n    var _this;\n\n    _classCallCheck(this, Wizard);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    }\n\n    _this = _super.call(this, element, options);\n    _this.pages = [];\n    _this.prefixComps = [];\n    _this.suffixComps = [];\n    _this.components = [];\n    _this.originalComponents = [];\n    _this.page = 0;\n    _this.currentPanel = null;\n    _this.currentPanels = null;\n    _this.currentNextPage = 0;\n    _this._seenPages = [0];\n    _this.subWizards = [];\n    _this.allPages = [];\n    _this.lastPromise = _nativePromiseOnly.default.resolve();\n    _this.enabledIndex = 0;\n    _this.editMode = false;\n    _this.originalOptions = _lodash.default.cloneDeep(_this.options);\n    return _this;\n  }\n\n  _createClass(Wizard, [{\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      var next = this.getNextPage();\n\n      if (_lodash.default.isNumber(next)) {\n        return next === -1;\n      }\n\n      return _lodash.default.isNull(next);\n    }\n  }, {\n    key: \"getPages\",\n    value: function getPages() {\n      var _this2 = this;\n\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _args$all = args.all,\n          all = _args$all === void 0 ? false : _args$all;\n      var pages = this.hasExtraPages ? this.components : this.pages;\n      var filteredPages = pages.filter(all ? _lodash.default.identity : function (p, index) {\n        return _this2._seenPages.includes(index);\n      });\n      return filteredPages;\n    }\n  }, {\n    key: \"hasExtraPages\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.subWizards);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return _get(_getPrototypeOf(Wizard.prototype), \"data\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      this._data = value;\n\n      _lodash.default.each(this.getPages({\n        all: true\n      }), function (component) {\n        component.data = _this3.componentContext(component);\n      });\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      this.establishPages(data);\n      return _get(_getPrototypeOf(Wizard.prototype), \"checkConditions\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.submitting ? this.getPages({\n        all: this.isLastPage()\n      }) : _get(_getPrototypeOf(Wizard.prototype), \"getComponents\", this).call(this);\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.getPages({\n        all: true\n      }).forEach(function (page) {\n        return page.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this4 = this;\n\n      // Check for and initlize button settings object\n      this.options.buttonSettings = _lodash.default.defaults(this.options.buttonSettings, {\n        showPrevious: true,\n        showNext: true,\n        showSubmit: true,\n        showCancel: !this.options.readOnly\n      });\n\n      if (!this.isSecondInit) {\n        var _this$options, _this$options$breadcr;\n\n        this.isClickableDefined = (_this$options = this.options) === null || _this$options === void 0 ? void 0 : (_this$options$breadcr = _this$options.breadcrumbSettings) === null || _this$options$breadcr === void 0 ? void 0 : _this$options$breadcr.hasOwnProperty('clickable');\n        this.isSecondInit = true;\n      }\n\n      this.options.breadcrumbSettings = _lodash.default.defaults(this.options.breadcrumbSettings, {\n        clickable: true\n      });\n      this.options.allowPrevious = this.options.allowPrevious || false;\n      this.page = 0;\n\n      var onReady = _get(_getPrototypeOf(Wizard.prototype), \"init\", this).call(this);\n\n      this.setComponentSchema();\n\n      if (this.pages && this.pages.length) {\n        this.component = this.pages[this.page].component;\n      }\n\n      this.on('subWizardsUpdated', function (subForm) {\n        var subWizard = _this4.subWizards.find(function (subWizard) {\n          var _subWizard$subForm;\n\n          return (subForm === null || subForm === void 0 ? void 0 : subForm.id) && ((_subWizard$subForm = subWizard.subForm) === null || _subWizard$subForm === void 0 ? void 0 : _subWizard$subForm.id) === (subForm === null || subForm === void 0 ? void 0 : subForm.id);\n        });\n\n        if (_this4.subWizards.length && subWizard) {\n          subWizard.subForm.setValue(subForm._submission, {}, true);\n\n          _this4.establishPages();\n\n          _this4.redraw();\n        }\n      });\n      return onReady;\n    }\n  }, {\n    key: \"wizardKey\",\n    get: function get() {\n      return \"wizard-\".concat(this.id);\n    }\n  }, {\n    key: \"wizard\",\n    get: function get() {\n      return this.form;\n    },\n    set: function set(form) {\n      this.setForm(form);\n    }\n  }, {\n    key: \"buttons\",\n    get: function get() {\n      var _this5 = this;\n\n      var buttons = {};\n      [{\n        name: 'cancel',\n        method: 'cancel'\n      }, {\n        name: 'previous',\n        method: 'prevPage'\n      }, {\n        name: 'next',\n        method: 'nextPage'\n      }, {\n        name: 'submit',\n        method: 'submit'\n      }].forEach(function (button) {\n        if (_this5.hasButton(button.name)) {\n          buttons[button.name] = button;\n        }\n      });\n      return buttons;\n    }\n  }, {\n    key: \"renderContext\",\n    get: function get() {\n      var _this$root, _this$root$component;\n\n      return {\n        wizardKey: this.wizardKey,\n        isBreadcrumbClickable: this.isBreadcrumbClickable(),\n        isSubForm: !!this.parent && !((_this$root = this.root) !== null && _this$root !== void 0 && (_this$root$component = _this$root.component) !== null && _this$root$component !== void 0 && _this$root$component.type) === 'wizard',\n        panels: this.allPages.length ? this.allPages.map(function (page) {\n          return page.component;\n        }) : this.pages.map(function (page) {\n          return page.component;\n        }),\n        buttons: this.buttons,\n        currentPage: this.page\n      };\n    }\n  }, {\n    key: \"prepareNavigationSettings\",\n    value: function prepareNavigationSettings(ctx) {\n      var currentPanel = this.currentPanel;\n\n      if (currentPanel && currentPanel.buttonSettings) {\n        Object.keys(currentPanel.buttonSettings).forEach(function () {\n          Object.keys(ctx.buttons).forEach(function (key) {\n            if (typeof currentPanel.buttonSettings[key] !== 'undefined' && !currentPanel.buttonSettings[key] || ctx.isSubForm) {\n              ctx.buttons[key] = null;\n            }\n          });\n        });\n      }\n\n      return this.renderTemplate('wizardNav', ctx);\n    }\n  }, {\n    key: \"prepareHeaderSettings\",\n    value: function prepareHeaderSettings(ctx) {\n      if (this.currentPanel && this.currentPanel.breadcrumb === 'none' || ctx.isSubForm) {\n        return null;\n      }\n\n      return this.renderTemplate('wizardHeader', ctx);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var ctx = this.renderContext;\n\n      if (this.component.key) {\n        ctx.panels.map(function (panel) {\n          if (panel.key === _this6.component.key) {\n            _this6.currentPanel = panel;\n            ctx.wizardPageTooltip = _this6.getFormattedTooltip(panel.tooltip);\n          }\n        });\n      }\n\n      var wizardNav = this.prepareNavigationSettings(ctx);\n      var wizardHeader = this.prepareHeaderSettings(ctx);\n      return this.renderTemplate('wizard', _objectSpread(_objectSpread({}, ctx), {}, {\n        className: _get(_getPrototypeOf(Wizard.prototype), \"getClassName\", this).call(this),\n        wizardHeader: wizardHeader,\n        wizardNav: wizardNav,\n        components: this.renderComponents([].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)))\n      }), this.builderMode ? 'builder' : 'form');\n    }\n  }, {\n    key: \"redrawNavigation\",\n    value: function redrawNavigation() {\n      if (this.element) {\n        var navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n\n        if (navElement) {\n          var _this$loadRefs;\n\n          this.detachNav();\n          navElement.outerHTML = this.renderTemplate('wizardNav', this.renderContext);\n          navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n          this.loadRefs(navElement, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _this$loadRefs));\n          this.attachNav();\n        }\n      }\n    }\n  }, {\n    key: \"redrawHeader\",\n    value: function redrawHeader() {\n      if (this.element) {\n        var headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n\n        if (headerElement) {\n          var _this$loadRefs2;\n\n          this.detachHeader();\n          headerElement.outerHTML = this.renderTemplate('wizardHeader', this.renderContext);\n          headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n          this.loadRefs(headerElement, (_this$loadRefs2 = {}, _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs2));\n          this.attachHeader();\n        }\n      }\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs3,\n          _this7 = this;\n\n      this.element = element;\n      this.loadRefs(element, (_this$loadRefs3 = {}, _defineProperty(_this$loadRefs3, this.wizardKey, 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs3));\n\n      if ((this.options.readOnly || this.editMode) && !this.enabledIndex) {\n        var _this$pages;\n\n        this.enabledIndex = ((_this$pages = this.pages) === null || _this$pages === void 0 ? void 0 : _this$pages.length) - 1;\n      }\n\n      var promises = this.attachComponents(this.refs[this.wizardKey], [].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)));\n      this.attachNav();\n      this.attachHeader();\n      return promises.then(function () {\n        _this7.emit('render', {\n          component: _this7.currentPage,\n          page: _this7.page\n        });\n\n        if (_this7.component.scrollToTop) {\n          _this7.scrollPageToTop();\n        }\n      });\n    }\n  }, {\n    key: \"scrollPageToTop\",\n    value: function scrollPageToTop() {\n      if (!this.refs[this.wizardKey]) {\n        return;\n      }\n\n      if ('scrollIntoView' in this.refs[this.wizardKey]) {\n        this.refs[this.wizardKey].scrollIntoView(true);\n      } else {\n        this.scrollIntoView(this.refs[this.wizardKey]);\n      }\n    }\n  }, {\n    key: \"isBreadcrumbClickable\",\n    value: function isBreadcrumbClickable() {\n      var _this8 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this8.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return this.isClickableDefined ? this.options.breadcrumbSettings.clickable : _lodash.default.get(currentPage, 'component.breadcrumbClickable', true);\n    }\n  }, {\n    key: \"isAllowPrevious\",\n    value: function isAllowPrevious() {\n      var _this9 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this9.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return _lodash.default.get(currentPage.component, 'allowPrevious', this.options.allowPrevious);\n    }\n  }, {\n    key: \"attachNav\",\n    value: function attachNav() {\n      var _this10 = this;\n\n      _lodash.default.each(this.buttons, function (button) {\n        var buttonElement = _this10.refs[\"\".concat(_this10.wizardKey, \"-\").concat(button.name)];\n\n        _this10.addEventListener(buttonElement, 'click', function (event) {\n          event.preventDefault(); // Disable the button until done.\n\n          buttonElement.setAttribute('disabled', 'disabled');\n\n          _this10.setLoading(buttonElement, true); // Call the button method, then re-enable the button.\n\n\n          _this10[button.method]().then(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          }).catch(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"emitWizardPageSelected\",\n    value: function emitWizardPageSelected(index) {\n      this.emit('wizardPageSelected', this.pages[index], index);\n    }\n  }, {\n    key: \"attachHeader\",\n    value: function attachHeader() {\n      var _this11 = this;\n\n      var isAllowPrevious = this.isAllowPrevious();\n      this.attachTooltips(this.refs[\"\".concat(this.wizardKey, \"-tooltip\")], this.currentPanel.tooltip);\n\n      if (this.isBreadcrumbClickable() || isAllowPrevious) {\n        var _this$refs$;\n\n        (_this$refs$ = this.refs[\"\".concat(this.wizardKey, \"-link\")]) === null || _this$refs$ === void 0 ? void 0 : _this$refs$.forEach(function (link, index) {\n          if (!isAllowPrevious || index <= _this11.enabledIndex) {\n            _this11.addEventListener(link, 'click', function (event) {\n              _this11.emit('wizardNavigationClicked', _this11.pages[index]);\n\n              event.preventDefault();\n              return _this11.setPage(index).then(function () {\n                _this11.emitWizardPageSelected(index);\n              });\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"detachNav\",\n    value: function detachNav() {\n      var _this12 = this;\n\n      _lodash.default.each(this.buttons, function (button) {\n        _this12.removeEventListener(_this12.refs[\"\".concat(_this12.wizardKey, \"-\").concat(button.name)], 'click');\n      });\n    }\n  }, {\n    key: \"detachHeader\",\n    value: function detachHeader() {\n      var _this13 = this;\n\n      if (this.refs[\"\".concat(this.wizardKey, \"-link\")]) {\n        this.refs[\"\".concat(this.wizardKey, \"-link\")].forEach(function (link) {\n          _this13.removeEventListener(link, 'click');\n        });\n      }\n    }\n  }, {\n    key: \"transformPages\",\n    value: function transformPages() {\n      var _this14 = this;\n\n      var allComponents = [];\n      var components = this.getSortedComponents(this);\n      var defferedComponents = [];\n      this.allPages = []; // Get all components including all nested components and line up in the correct order\n\n      var getAllComponents = function getAllComponents(nestedComp, compsArr) {\n        var pushAllowed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var nestedPages = [];\n        var dataArrayComponents = ['datagrid', 'editgrid', 'dynamicWizard'];\n        var currentComponents = nestedComp !== null && nestedComp !== void 0 && nestedComp.subForm ? _this14.getSortedComponents(nestedComp.subForm) : (nestedComp === null || nestedComp === void 0 ? void 0 : nestedComp.components) || [];\n        var visibleComponents = currentComponents.filter(function (comp) {\n          return comp._visible;\n        });\n        var filteredComponents = visibleComponents.filter(function (comp) {\n          return !dataArrayComponents.includes(comp.component.type) && (comp.type !== 'form' || comp.isNestedWizard);\n        });\n        var additionalComponents = visibleComponents.filter(function (comp) {\n          var _comp$subForm;\n\n          return ((_comp$subForm = comp.subForm) === null || _comp$subForm === void 0 ? void 0 : _comp$subForm._form.display) !== 'wizard';\n        });\n        var hasNested = false;\n        (0, _utils.eachComponent)(filteredComponents, function (comp) {\n          if (comp.component.type === 'panel' && comp !== null && comp !== void 0 && comp.parent.wizard && !getAllComponents(comp, compsArr, false)) {\n            if (pushAllowed) {\n              _this14.setRootPanelId(comp);\n\n              nestedPages.push(comp);\n            }\n\n            hasNested = true;\n          }\n\n          if (comp && comp.isNestedWizard && comp.subForm) {\n            var hasNestedForm = getAllComponents(comp, nestedPages, pushAllowed);\n\n            if (!hasNested) {\n              hasNested = hasNestedForm;\n            }\n          }\n        }, true);\n\n        if (nestedComp.component.type === 'panel') {\n          if (!hasNested && pushAllowed) {\n            _this14.setRootPanelId(nestedComp);\n\n            compsArr.push(nestedComp);\n          }\n\n          if (hasNested && additionalComponents.length) {\n            var newComp = _lodash.default.clone(nestedComp);\n\n            newComp.components = additionalComponents;\n\n            _this14.setRootPanelId(newComp);\n\n            defferedComponents.push(newComp);\n          }\n        }\n\n        if (pushAllowed) {\n          compsArr.push.apply(compsArr, _toConsumableArray(defferedComponents).concat(nestedPages));\n          defferedComponents = [];\n        }\n\n        return hasNested;\n      };\n\n      components.forEach(function (component) {\n        getAllComponents(component, allComponents);\n      }, []); // recalculate pages only for root wizards, including the situation when the wizard is in a wrapper\n\n      if (this.localRoot && this.id === this.localRoot.id) {\n        allComponents.forEach(function (comp, index) {\n          comp.eachComponent(function (component) {\n            component.page = index;\n          });\n        });\n      }\n\n      this.allPages = allComponents;\n    }\n  }, {\n    key: \"getSortedComponents\",\n    value: function getSortedComponents(_ref) {\n      var components = _ref.components,\n          originalComponents = _ref.originalComponents;\n      // sorts components if they were shuffled after the conditional logic\n      var currentComponents = [];\n      var currentPages = [];\n\n      if (components && components.length) {\n        components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      originalComponents === null || originalComponents === void 0 ? void 0 : originalComponents.forEach(function (item) {\n        if (!item.key) {\n          item.key = item.title;\n        }\n\n        if (currentPages[item.key]) {\n          currentComponents.push(currentPages[item.key]);\n        }\n      });\n      return currentComponents;\n    }\n  }, {\n    key: \"findRootPanel\",\n    value: function findRootPanel(component) {\n      var _component$parent;\n\n      return (_component$parent = component.parent) !== null && _component$parent !== void 0 && _component$parent.parent ? this.findRootPanel(component.parent) : component;\n    }\n  }, {\n    key: \"setRootPanelId\",\n    value: function setRootPanelId(component) {\n      var _component$parent2;\n\n      if (component.rootPanelId && component.rootPanelId !== component.id) {\n        return;\n      }\n\n      var parent = (_component$parent2 = component.parent) !== null && _component$parent2 !== void 0 && _component$parent2.parent ? this.findRootPanel(component.parent) : component;\n      component.rootPanelId = parent.id;\n    }\n  }, {\n    key: \"establishPages\",\n    value: function establishPages() {\n      var _this15 = this;\n\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.data;\n      this.pages = [];\n      this.prefixComps = [];\n      this.suffixComps = [];\n      var visible = [];\n      var currentPages = {};\n\n      var pageOptions = _lodash.default.clone(this.options);\n\n      if (this.components && this.components.length) {\n        this.components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      if (this.originalComponents) {\n        this.originalComponents.forEach(function (item) {\n          if (item.type === 'panel') {\n            if (!item.key) {\n              item.key = item.title;\n            }\n\n            var page = currentPages[item.key];\n            var forceShow = _this15.options.show ? _this15.options.show[item.key] : false;\n            var forceHide = _this15.options.hide ? _this15.options.hide[item.key] : false;\n            var isVisible = (0, _utils.checkCondition)(item, data, data, _this15.component, _this15) && !item.hidden;\n\n            if (forceShow) {\n              isVisible = true;\n            } else if (forceHide) {\n              isVisible = false;\n            }\n\n            if (isVisible) {\n              visible.push(item);\n\n              if (page) {\n                _this15.pages.push(page);\n              }\n            }\n\n            if (!page && isVisible) {\n              page = _this15.createComponent(item, pageOptions);\n              page.visible = isVisible;\n\n              _this15.pages.push(page);\n\n              page.eachComponent(function (component) {\n                component.page = _this15.pages.length - 1;\n              });\n            } else if (page && !isVisible) {\n              _this15.removeComponent(page);\n            }\n          } else if (item.type !== 'button') {\n            if (!_this15.pages.length) {\n              _this15.prefixComps.push(_this15.createComponent(item, pageOptions));\n            } else {\n              _this15.suffixComps.push(_this15.createComponent(item, pageOptions));\n            }\n          }\n        });\n      }\n\n      if (this.pages.length) {\n        this.emit('pagesChanged');\n      }\n\n      this.transformPages();\n\n      if (this.allPages && this.allPages.length) {\n        this.updatePages();\n      }\n\n      return visible;\n    }\n  }, {\n    key: \"updatePages\",\n    value: function updatePages() {\n      this.pages = this.allPages;\n    }\n  }, {\n    key: \"addComponents\",\n    value: function addComponents() {\n      this.establishPages();\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(num) {\n      var _this16 = this;\n\n      if (num === this.page) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (num >= 0 && num < this.pages.length) {\n        this.page = num;\n        this.pageFieldLogic(num);\n        this.getNextPage();\n        var parentNum = num;\n\n        if (this.hasExtraPages) {\n          var pageFromPages = this.pages[num];\n          var pageFromComponents = this.components[num];\n\n          if (!pageFromComponents || pageFromPages.id !== pageFromComponents.id) {\n            parentNum = this.components.findIndex(function (comp) {\n              return comp.id === _this16.pages[parentNum].rootPanelId;\n            });\n          }\n        }\n\n        if (!this._seenPages.includes(parentNum)) {\n          this._seenPages = this._seenPages.concat(parentNum);\n        }\n\n        this.redraw().then(function () {\n          _this16.checkData(_this16.submission.data);\n        });\n        return _nativePromiseOnly.default.resolve();\n      } else if (!this.pages.length) {\n        this.redraw();\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      return _nativePromiseOnly.default.reject('Page not found');\n    }\n  }, {\n    key: \"pageFieldLogic\",\n    value: function pageFieldLogic(page) {\n      // Handle field logic on pages.\n      this.component = this.pages[page].component;\n      this.originalComponent = (0, _utils.fastCloneDeep)(this.component);\n      this.fieldLogic(this.data); // If disabled changed, be sure to distribute the setting.\n\n      this.disabled = this.shouldDisabled;\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      return this.pages && this.pages.length >= this.page ? this.pages[this.page] : {\n        components: []\n      };\n    }\n  }, {\n    key: \"getNextPage\",\n    value: function getNextPage() {\n      var data = this.submission.data;\n      var form = this.pages[this.page].component; // Check conditional nextPage\n\n      if (form) {\n        var page = this.pages.length > this.page + 1 && !this.showAllErrors ? this.page + 1 : -1;\n\n        if (form.nextPage) {\n          var next = this.evaluate(form.nextPage, {\n            next: page,\n            data: data,\n            page: page,\n            form: form\n          }, 'next');\n\n          if (next === null) {\n            this.currentNextPage = null;\n            return null;\n          }\n\n          var pageNum = parseInt(next, 10);\n\n          if (!isNaN(parseInt(pageNum, 10)) && isFinite(pageNum)) {\n            this.currentNextPage = pageNum;\n            return pageNum;\n          }\n\n          this.currentNextPage = this.getPageIndexByKey(next);\n          return this.currentNextPage;\n        }\n\n        this.currentNextPage = page;\n        return page;\n      }\n\n      this.currentNextPage = null;\n      return null;\n    }\n  }, {\n    key: \"getPreviousPage\",\n    value: function getPreviousPage() {\n      return this.page - 1;\n    }\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var pages = this.getPages();\n      return _nativePromiseOnly.default.all(pages.map(function (page) {\n        page.options.beforeSubmit = true;\n        return page.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this17 = this;\n\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this17.hook(next ? 'beforeNext' : 'beforePrev', _this17.currentPage, _this17.submission, function (err) {\n          if (err) {\n            _this17.showErrors(err, true);\n\n            reject(err);\n          }\n\n          var form = _this17.currentPage;\n\n          if (form) {\n            form.beforePage(next).then(resolve).catch(reject);\n          } else {\n            resolve();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"emitNextPage\",\n    value: function emitNextPage() {\n      this.emit('nextPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"nextPage\",\n    value: function nextPage() {\n      var _this18 = this;\n\n      // Read-only forms should not worry about validation before going to next page, nor should they submit.\n      if (this.options.readOnly) {\n        return this.setPage(this.getNextPage()).then(function () {\n          _this18.emit('nextPage', {\n            page: _this18.page,\n            submission: _this18.submission\n          });\n        });\n      } // Validate the form, before go to the next page\n\n\n      if (this.checkValidity(this.submission.data, true, this.submission.data, true)) {\n        this.checkData(this.submission.data);\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            if (!(_this18.options.readOnly || _this18.editMode) && _this18.enabledIndex < _this18.page) {\n              _this18.enabledIndex = _this18.page;\n\n              _this18.redraw();\n            }\n\n            _this18.emitNextPage();\n          });\n        });\n      } else {\n        this.currentPage.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n        return _nativePromiseOnly.default.reject(this.showErrors([], true));\n      }\n    }\n  }, {\n    key: \"emitPrevPage\",\n    value: function emitPrevPage() {\n      this.emit('prevPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"prevPage\",\n    value: function prevPage() {\n      var _this19 = this;\n\n      return this.beforePage().then(function () {\n        return _this19.setPage(_this19.getPreviousPage()).then(function () {\n          _this19.emitPrevPage();\n        });\n      });\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var _this20 = this;\n\n      if (this.options.readOnly) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (_get(_getPrototypeOf(Wizard.prototype), \"cancel\", this).call(this, noconfirm)) {\n        this.setPristine(true);\n        return this.setPage(0).then(function () {\n          if (_this20.enabledIndex) {\n            _this20.enabledIndex = 0;\n          }\n\n          _this20.onChange();\n\n          _this20.redraw();\n\n          return _this20.page;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"getPageIndexByKey\",\n    value: function getPageIndexByKey(key) {\n      var pageIndex = this.page;\n      this.pages.forEach(function (page, index) {\n        if (page.component.key === key) {\n          pageIndex = index;\n          return false;\n        }\n      });\n      return pageIndex;\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.wizard;\n    }\n  }, {\n    key: \"setComponentSchema\",\n    value: function setComponentSchema() {\n      var _this21 = this;\n\n      var pageKeys = {};\n      this.originalComponents = [];\n      this.component.components.map(function (item) {\n        if (item.type === 'panel') {\n          item.key = (0, _utils.uniqueKey)(pageKeys, item.key || 'panel');\n          pageKeys[item.key] = true;\n\n          if (_this21.wizard.full) {\n            _this21.options.show = _this21.options.show || {};\n            _this21.options.show[item.key] = true;\n          } else if (_this21.wizard.hasOwnProperty('full') && !_lodash.default.isEqual(_this21.originalOptions.show, _this21.options.show)) {\n            _this21.options.show = _objectSpread({}, _this21.originalOptions.show || {});\n          }\n        }\n\n        _this21.originalComponents.push(_lodash.default.clone(item));\n      });\n\n      if (!Object.keys(pageKeys).length) {\n        var newPage = {\n          type: 'panel',\n          title: 'Page 1',\n          label: 'Page 1',\n          key: 'page1',\n          components: this.component.components\n        };\n        this.component.components = [newPage];\n        this.originalComponents.push(_lodash.default.clone(newPage));\n      }\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      if (!form) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"setForm\", this).call(this, form, flags);\n    }\n  }, {\n    key: \"onSetForm\",\n    value: function onSetForm(clonedForm, initialForm) {\n      this.component.components = (this._parentPath ? initialForm.components : clonedForm.components) || [];\n      this.setComponentSchema();\n    }\n  }, {\n    key: \"setEditMode\",\n    value: function setEditMode(submission) {\n      if (!this.editMode && submission._id && !this.options.readOnly) {\n        this.editMode = true;\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this22 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var ignoreEstablishment = arguments.length > 2 ? arguments[2] : undefined;\n      this._submission = submission;\n\n      if (flags && flags.fromSubmission && (this.options.readOnly || this.editMode) && !this.isHtmlRenderMode()) {\n        this._data = submission.data;\n      }\n\n      if (!ignoreEstablishment) {\n        this.establishPages(submission.data);\n      }\n\n      var changed = this.getPages({\n        all: true\n      }).reduce(function (changed, page) {\n        return _this22.setNestedValue(page, submission.data, flags, changed) || changed;\n      }, false);\n      this.pageFieldLogic(this.page);\n      this.setEditMode(submission);\n      return changed;\n    }\n  }, {\n    key: \"isClickable\",\n    value: function isClickable(page, index) {\n      return this.page !== index && (0, _utils.firstNonNil)([_lodash.default.get(page, 'breadcrumbClickable'), this.options.breadcrumbSettings.clickable]);\n    }\n  }, {\n    key: \"hasButton\",\n    value: function hasButton(name) {\n      var nextPage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getNextPage();\n\n      // get page options with global options as default values\n      var _$get = _lodash.default.get(this.currentPage, 'component.buttonSettings', {}),\n          _$get$previous = _$get.previous,\n          previous = _$get$previous === void 0 ? this.options.buttonSettings.showPrevious : _$get$previous,\n          _$get$cancel = _$get.cancel,\n          cancel = _$get$cancel === void 0 ? this.options.buttonSettings.showCancel : _$get$cancel,\n          _$get$submit = _$get.submit,\n          submit = _$get$submit === void 0 ? this.options.buttonSettings.showSubmit : _$get$submit,\n          _$get$next = _$get.next,\n          next = _$get$next === void 0 ? this.options.buttonSettings.showNext : _$get$next;\n\n      switch (name) {\n        case 'previous':\n          return previous && this.getPreviousPage() > -1;\n\n        case 'next':\n          return next && nextPage !== null && nextPage !== -1;\n\n        case 'cancel':\n          return cancel && !this.options.readOnly;\n\n        case 'submit':\n          return submit && !this.options.readOnly && (nextPage === null || this.page === this.pages.length - 1);\n\n        default:\n          return true;\n      }\n    }\n  }, {\n    key: \"pageId\",\n    value: function pageId(page) {\n      if (page.key) {\n        // Some panels have the same key....\n        return \"\".concat(page.key, \"-\").concat(page.title);\n      } else if (page.components && page.components.length > 0) {\n        return this.pageId(page.components[0]);\n      } else {\n        return page.title;\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      var _this23 = this;\n\n      _get(_getPrototypeOf(Wizard.prototype), \"onChange\", this).call(this, flags, changed, modified, changes);\n\n      if (this.alert && !this.submitted) {\n        this.checkValidity(this.submission.data, false, this.submission.data, true);\n        this.showErrors([], true, true);\n      } // If the pages change, need to redraw the header.\n\n\n      var currentPanels;\n      var panels;\n      var currentNextPage = this.currentNextPage;\n\n      if (this.hasExtraPages) {\n        currentPanels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n        this.establishPages();\n        panels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n      } else {\n        currentPanels = this.currentPanels || this.pages.map(function (page) {\n          return page.component.key;\n        });\n        panels = this.establishPages().map(function (panel) {\n          return panel.key;\n        });\n        this.currentPanels = panels;\n\n        if (this.currentPanel && this.currentPanel.key) {\n          this.setPage(this.currentPanels.findIndex(function (panel) {\n            return panel === _this23.currentPanel.key;\n          }));\n        }\n      }\n\n      if (!_lodash.default.isEqual(panels, currentPanels) || flags && flags.fromSubmission) {\n        this.redrawHeader();\n      } // If the next page changes, then make sure to redraw navigation.\n\n\n      if (currentNextPage !== this.getNextPage()) {\n        this.redrawNavigation();\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      var _this$parent, _this$parent$componen;\n\n      if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n        return this.parent.redraw();\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"redraw\", this).call(this);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, currentPageOnly) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var components = !currentPageOnly || this.isLastPage() ? this.getComponents() : this.currentPage.components;\n      return components.reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row) && check;\n      }, true);\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      if (!this.isLastPage()) {\n        return this.currentPage.errors;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"errors\", this);\n    }\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      var _this24 = this;\n\n      var pageIndex = 0;\n\n      var _this$pages$filter = this.pages.filter(function (page, index) {\n        if (page.getComponent(key)) {\n          pageIndex = index;\n          return true;\n        }\n\n        return false;\n      }),\n          _this$pages$filter2 = _slicedToArray(_this$pages$filter, 1),\n          page = _this$pages$filter2[0];\n\n      if (page && page !== this.currentPage) {\n        return this.setPage(pageIndex).then(function () {\n          _this24.checkValidity(_this24.submission.data, true, _this24.submission.data);\n\n          _this24.showErrors();\n\n          _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", _this24).call(_this24, key);\n        });\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", this).call(this, key);\n    }\n  }]);\n\n  return Wizard;\n}(_Webform2.default);\n\nexports.default = Wizard;\nWizard.setBaseUrl = _Formio.default.setBaseUrl;\nWizard.setApiUrl = _Formio.default.setApiUrl;\nWizard.setAppUrl = _Formio.default.setAppUrl;"]},"metadata":{},"sourceType":"script"}