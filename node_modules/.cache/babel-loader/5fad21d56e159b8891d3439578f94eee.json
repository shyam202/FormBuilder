{"ast":null,"code":"'use strict';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _Components = _interopRequireDefault(require(\"../../Components\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../../utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction set(target, property, value, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.set) {\n    set = Reflect.set;\n  } else {\n    set = function set(target, property, value, receiver) {\n      var base = _superPropBase(target, property);\n\n      var desc;\n\n      if (base) {\n        desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.set) {\n          desc.set.call(receiver, value);\n          return true;\n        } else if (!desc.writable) {\n          return false;\n        }\n      }\n\n      desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n      if (desc) {\n        if (!desc.writable) {\n          return false;\n        }\n\n        desc.value = value;\n        Object.defineProperty(receiver, property, desc);\n      } else {\n        _defineProperty(receiver, property, value);\n      }\n\n      return true;\n    };\n  }\n\n  return set(target, property, value, receiver);\n}\n\nfunction _set(target, property, value, receiver, isStrict) {\n  var s = set(target, property, value, receiver || target);\n\n  if (!s && isStrict) {\n    throw new Error('failed to set property');\n  }\n\n  return value;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar NestedComponent = /*#__PURE__*/function (_Field) {\n  _inherits(NestedComponent, _Field);\n\n  var _super = _createSuper(NestedComponent);\n\n  function NestedComponent(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, NestedComponent);\n\n    _this = _super.call(this, component, options, data);\n    _this.type = 'components';\n    _this._collapsed = !!_this.component.collapsed;\n    return _this;\n  }\n\n  _createClass(NestedComponent, [{\n    key: \"defaultSchema\",\n    get: function get() {\n      return NestedComponent.schema();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = _get(_getPrototypeOf(NestedComponent.prototype), \"schema\", this);\n\n      var components = _lodash.default.uniqBy(this.getComponents(), 'component.key');\n\n      schema.components = _lodash.default.map(components, 'schema');\n      return schema;\n    }\n  }, {\n    key: \"collapsed\",\n    get: function get() {\n      return this._collapsed;\n    },\n    set: function set(value) {\n      this._collapsed = value;\n      this.redraw();\n\n      if (!value && !this.pristine) {\n        this.checkValidity(this.data, true);\n      }\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      // DO NOT CALL super here.  There is an issue where clearOnHide was getting triggered with\n      // subcomponents because the \"parentVisible\" flag was set to false when it should really be\n      // set to true.\n      var visibilityChanged = this._visible !== value;\n      this._visible = value;\n      var isVisible = this.visible;\n      var forceShow = this.options.show && this.options.show[this.component.key];\n      var forceHide = this.options.hide && this.options.hide[this.component.key];\n      this.components.forEach(function (component) {\n        // Set the parent visibility first since we may have nested components within nested components\n        // and they need to be able to determine their visibility based on the parent visibility.\n        component.parentVisible = isVisible;\n        var conditionallyVisible = component.conditionallyVisible();\n\n        if (forceShow || conditionallyVisible) {\n          component.visible = true;\n        } else if (forceHide || !isVisible || !conditionallyVisible) {\n          component.visible = false;\n        } // If hiding a nested component, clear all errors below.\n\n\n        if (!component.visible) {\n          component.error = '';\n        }\n      });\n\n      if (visibilityChanged) {\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this2 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", value, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentVisible = _this2.visible;\n      });\n    }\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"disabled\", this);\n    },\n    set: function set(disabled) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"disabled\", disabled, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentDisabled = disabled;\n      });\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", value, this, true);\n\n      this.components.forEach(function (component) {\n        component.parentDisabled = _this3.disabled;\n      });\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.ready;\n      }));\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", this);\n    },\n    set: function set(instance) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", instance, this, true);\n\n      this.getComponents().forEach(function (component) {\n        component.currentForm = instance;\n      });\n    }\n  }, {\n    key: \"rowIndex\",\n    get: function get() {\n      return this._rowIndex;\n    },\n    set: function set(value) {\n      this._rowIndex = value;\n      this.eachComponent(function (component) {\n        component.rowIndex = value;\n      });\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      var _this4 = this;\n\n      this._data = value;\n      this.eachComponent(function (component) {\n        component.data = _this4.componentContext(component);\n      });\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.components || [];\n    }\n    /**\n     * Perform a deep iteration over every component, including those\n     * within other container based components.\n     *\n     * @param {function} fn - Called for every component.\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent(fn, options) {\n      var components = this.getComponents();\n\n      _lodash.default.each(components, function (component, index) {\n        if (fn(component, components, index) === false) {\n          return false;\n        }\n\n        if (typeof component.everyComponent === 'function') {\n          if (component.everyComponent(fn, options) === false) {\n            return false;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"hasComponent\",\n    value: function hasComponent(component) {\n      var result = false;\n      this.everyComponent(function (comp) {\n        if (comp === component) {\n          result = true;\n          return false;\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents() {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      });\n      return result;\n    }\n    /**\n     * Perform an iteration over each component within this container component.\n     *\n     * @param {function} fn - Called for each component\n     */\n\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn) {\n      _lodash.default.each(this.getComponents(), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n    /**\n     * Returns a component provided a key. This performs a deep search within the\n     * component tree.\n     *\n     * @param {string} key - The key of the component to retrieve.\n     * @param {function} fn - Called with the component once found.\n     * @return {Object} - The component that is located.\n     */\n\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn, originalPath) {\n      originalPath = originalPath || (0, _utils.getStringFromComponentPath)(path);\n      path = (0, _utils.getArrayFromComponentPath)(path);\n      var pathStr = originalPath;\n\n      var newPath = _lodash.default.clone(path);\n\n      var key = newPath.shift();\n      var remainingPath = newPath;\n      var comp = null;\n      var possibleComp = null;\n\n      if (_lodash.default.isNumber(key)) {\n        key = remainingPath.shift();\n      }\n\n      if (!_lodash.default.isString(key)) {\n        return comp;\n      }\n\n      this.everyComponent(function (component, components) {\n        var matchPath = component.hasInput && component.path ? pathStr.includes(component.path) : true;\n\n        if (component.component.key === key) {\n          possibleComp = component;\n\n          if (matchPath) {\n            comp = component;\n\n            if (remainingPath.length > 0 && 'getComponent' in component) {\n              comp = component.getComponent(remainingPath, fn, originalPath);\n            } else if (fn) {\n              fn(component, components);\n            }\n\n            return false;\n          }\n        }\n      });\n\n      if (!comp) {\n        comp = possibleComp;\n      }\n\n      return comp;\n    }\n    /**\n     * Return a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component.\n     * @param {function} fn - Called with the component once it is retrieved.\n     * @return {Object} - The component retrieved.\n     */\n\n  }, {\n    key: \"getComponentById\",\n    value: function getComponentById(id, fn) {\n      var comp = null;\n      this.everyComponent(function (component, components) {\n        if (component.id === id) {\n          comp = component;\n\n          if (fn) {\n            fn(component, components);\n          }\n\n          return false;\n        }\n      });\n      return comp;\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        var thisPath = this;\n\n        while (thisPath && !thisPath.allowData && thisPath.parent) {\n          thisPath = thisPath.parent;\n        }\n\n        var rowIndex = component.row ? \"[\".concat(Number.parseInt(component.row), \"]\") : '';\n        path = thisPath.path ? \"\".concat(thisPath.path).concat(rowIndex, \".\") : '';\n        path += component._parentPath && component.component.shouldIncludeSubFormPath ? component._parentPath : '';\n        path += component.component.key;\n        return path;\n      }\n    }\n    /**\n     * Create a new component and add it to the components array.\n     *\n     * @param component\n     * @param data\n     */\n\n  }, {\n    key: \"createComponent\",\n    value: function createComponent(component, options, data, before) {\n      if (!component) {\n        return;\n      }\n\n      options = options || this.options;\n      data = data || this.data;\n      options.parent = this;\n      options.parentVisible = this.visible;\n      options.root = this.root || this;\n      options.localRoot = this.localRoot;\n      options.skipInit = true;\n\n      if (!this.isInputComponent && this.component.shouldIncludeSubFormPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      var comp = _Components.default.create(component, options, data, true);\n\n      var path = this.calculateComponentPath(comp);\n\n      if (path) {\n        comp.path = path;\n      }\n\n      comp.init();\n\n      if (component.internal) {\n        return comp;\n      }\n\n      if (before) {\n        var index = _lodash.default.findIndex(this.components, {\n          id: before.id\n        });\n\n        if (index !== -1) {\n          this.components.splice(index, 0, comp);\n        } else {\n          this.components.push(comp);\n        }\n      } else {\n        this.components.push(comp);\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.element;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.component.components || [];\n    }\n  }, {\n    key: \"nestedKey\",\n    get: function get() {\n      return \"nested-\".concat(this.key);\n    }\n  }, {\n    key: \"templateName\",\n    get: function get() {\n      return 'container';\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.components = this.components || [];\n      this.addComponents();\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"init\", this).call(this);\n    }\n    /**\n     *\n     * @param element\n     * @param data\n     */\n\n  }, {\n    key: \"addComponents\",\n    value: function addComponents(data, options) {\n      var _this5 = this;\n\n      data = data || this.data;\n      options = options || this.options;\n\n      if (options.components) {\n        this.components = options.components;\n      } else {\n        var components = this.hook('addComponents', this.componentComponents, this) || [];\n        components.forEach(function (component) {\n          return _this5.addComponent(component, data);\n        });\n      }\n    }\n    /**\n     * Add a new component to the components array.\n     *\n     * @param {Object} component - The component JSON schema to add.\n     * @param {Object} data - The submission data object to house the data for this component.\n     * @param {HTMLElement} before - A DOM element to insert this element before.\n     * @return {Component} - The created component instance.\n     */\n\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(component, data, before, noAdd) {\n      data = data || this.data;\n\n      if (this.options.parentPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      component = this.hook('addComponent', component, data, before, noAdd);\n      var comp = this.createComponent(component, this.options, data, before ? before : null);\n\n      if (noAdd) {\n        return comp;\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus() {\n      if (this.parent && 'beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      // If already rendering, don't re-render.\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(this.templateName, {\n        children: this.renderComponents(),\n        nestedKey: this.nestedKey,\n        collapsed: this.options.pdf ? false : this.collapsed\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      return this.renderTemplate('components', {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this6 = this;\n\n      var superPromise = _get(_getPrototypeOf(NestedComponent.prototype), \"attach\", this).call(this, element);\n\n      this.loadRefs(element, _defineProperty({\n        header: 'single',\n        collapsed: this.collapsed\n      }, this.nestedKey, 'single'));\n\n      var childPromise = _nativePromiseOnly.default.resolve();\n\n      if (this.refs[this.nestedKey]) {\n        childPromise = this.attachComponents(this.refs[this.nestedKey]);\n      }\n\n      if (this.component.collapsible && this.refs.header) {\n        this.addEventListener(this.refs.header, 'click', function () {\n          _this6.collapsed = !_this6.collapsed;\n        });\n        this.addEventListener(this.refs.header, 'keydown', function (e) {\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            e.preventDefault();\n            _this6.collapsed = !_this6.collapsed;\n          }\n        });\n      }\n\n      return _nativePromiseOnly.default.all([superPromise, childPromise]);\n    }\n  }, {\n    key: \"attachComponents\",\n    value: function attachComponents(element, components, container) {\n      components = components || this.components;\n      container = container || this.component.components;\n      element = this.hook('attachComponents', element, components, container, this);\n\n      if (!element) {\n        // Return a non-resolving promise.\n        return new _nativePromiseOnly.default(function () {});\n      }\n\n      var index = 0;\n      var promises = [];\n      Array.prototype.slice.call(element.children).forEach(function (child) {\n        if (!child.getAttribute('data-noattach') && components[index]) {\n          promises.push(components[index].attach(child));\n          index++;\n        }\n      });\n      return _nativePromiseOnly.default.all(promises);\n    }\n    /**\n     * Remove a component from the components array.\n     *\n     * @param {Component} component - The component to remove from the components.\n     * @param {Array<Component>} components - An array of components to remove this component from.\n     */\n\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, components) {\n      components = components || this.components;\n      component.destroy();\n\n      _lodash.default.remove(components, {\n        id: component.id\n      });\n    }\n    /**\n     * Removes a component provided the API key of that component.\n     *\n     * @param {string} key - The API key of the component to remove.\n     * @param {function} fn - Called once the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentByKey\",\n    value: function removeComponentByKey(key, fn) {\n      var _this7 = this;\n\n      var comp = this.getComponent(key, function (component, components) {\n        _this7.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n    /**\n     * Removes a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component to remove.\n     * @param {function} fn - Called when the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentById\",\n    value: function removeComponentById(id, fn) {\n      var _this8 = this;\n\n      var comp = this.getComponentById(id, function (component, components) {\n        _this8.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.components.reduce(function (changed, comp) {\n        return comp.updateValue(null, flags) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"updateValue\", this).call(this, value, flags));\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      // Nested components with no input should not be validated.\n      if (!this.component.input) {\n        return true;\n      } else {\n        return _get(_getPrototypeOf(NestedComponent.prototype), \"shouldSkipValidation\", this).call(this, data, dirty, row);\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row, components) {\n      if (this.builderMode) {\n        return true;\n      }\n\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      components = components && _lodash.default.isArray(components) ? components : this.getComponents();\n      var isValid = components.reduce(function (valid, comp) {\n        return comp.checkData(data, flags, row) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkData\", this).call(this, data, flags, row));\n      this.checkModal(isValid, this.isDirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkModal\",\n    value: function checkModal(isValid, dirty) {\n      if (!this.component.modalEdit || !this.componentModal) {\n        return;\n      }\n\n      var messages = this.errors;\n      this.clearErrorClasses(this.refs.openModalWrapper);\n      this.error = '';\n\n      if (!isValid && (dirty || !this.isPristine && !!messages.length)) {\n        this.error = {\n          component: this.component,\n          level: 'hidden',\n          message: this.t('Fix the errors'),\n          messages: messages\n        };\n        this.setErrorClasses([this.refs.openModal], dirty, !isValid, !!messages.length, this.refs.openModalWrapper);\n      }\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      this.getComponents().forEach(function (comp) {\n        return comp.checkConditions(data, flags, row);\n      });\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"checkConditions\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide(show) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clearOnHide\", this).call(this, show);\n\n      if (this.component.clearOnHide) {\n        if (this.allowData && !this.hasValue()) {\n          this.dataValue = this.defaultValue;\n        }\n\n        if (this.hasValue()) {\n          this.restoreComponentsContext();\n        }\n      }\n\n      this.getComponents().forEach(function (component) {\n        return component.clearOnHide(show);\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this9 = this;\n\n      this.getComponents().forEach(function (component) {\n        return component.data = _this9.dataValue;\n      });\n    }\n    /**\n     * Allow components to hook into the next page trigger to perform their own logic.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforePage(next);\n      }));\n    }\n    /**\n     * Allow components to hook into the submission to provide their own async data.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      // Do not iterate into children and calculateValues if this nested component is conditionally hidden.\n      if (!this.conditionallyVisible()) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, comp) {\n        return comp.calculateValue(data, flags, row) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"calculateValue\", this).call(this, data, flags, row));\n    }\n  }, {\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      return this.pages.length - 1 === this.page;\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return this.getComponents().reduce(function (valid, comp) {\n        return comp.isValid(data, dirty) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"isValid\", this).call(this, data, dirty));\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var isValid = this.getComponents().reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row, silentCheck) && check;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkValidity\", this).call(this, data, dirty, row, silentCheck));\n      this.checkModal(isValid, dirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      var _this10 = this;\n\n      return this.ready.then(function () {\n        var promises = [_get(_getPrototypeOf(NestedComponent.prototype), \"checkAsyncValidity\", _this10).call(_this10, data, dirty, row, silentCheck)];\n\n        _this10.eachComponent(function (component) {\n          return promises.push(component.checkAsyncValidity(data, dirty, row, silentCheck));\n        });\n\n        return _nativePromiseOnly.default.all(promises).then(function (results) {\n          return results.reduce(function (valid, result) {\n            return valid && result;\n          }, true);\n        });\n      });\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.setPristine(pristine);\n      });\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine && this.getComponents().every(function (c) {\n        return c.isPristine;\n      });\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty && this.getComponents().every(function (c) {\n        return c.isDirty;\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.components.forEach(function (component) {\n        component.detach();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.components.forEach(function (component) {\n        component.clear();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clear\", this).call(this);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.destroyComponents();\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents() {\n      var _this11 = this;\n\n      var components = this.getComponents().slice();\n      components.forEach(function (comp) {\n        return _this11.removeComponent(comp, _this11.components);\n      });\n      this.components = [];\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var thisErrors = this.error ? [this.error] : [];\n      return this.getComponents().reduce(function (errors, comp) {\n        return errors.concat(comp.errors || []);\n      }, thisErrors).filter(function (err) {\n        return err.level !== 'hidden';\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      return this.data;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"resetValue\", this).call(this);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.dataReady;\n      }));\n    }\n  }, {\n    key: \"setNestedValue\",\n    value: function setNestedValue(component, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      component._data = this.componentContext(component);\n\n      if (component.type === 'button') {\n        return false;\n      }\n\n      if (component.type === 'components') {\n        return component.setValue(value, flags);\n      } else if (value && component.hasValue(value)) {\n        return component.setValue(_lodash.default.get(value, component.key), flags);\n      } else if (!this.rootPristine || component.visible) {\n        flags.noValidate = !flags.dirty;\n        flags.resetValue = true;\n        return component.setValue(component.defaultValue, flags);\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this12 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, component) {\n        return _this12.setNestedValue(component, value, flags, changed) || changed;\n      }, false);\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len = arguments.length, extend = new Array(_len), _key = 0; _key < _len; _key++) {\n        extend[_key] = arguments[_key];\n      }\n\n      return _Field2.default.schema.apply(_Field2.default, [{\n        tree: false\n      }].concat(extend));\n    }\n  }]);\n\n  return NestedComponent;\n}(_Field2.default);\n\nexports.default = NestedComponent;","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/formiojs/components/_classes/nested/NestedComponent.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","require","_Field2","_Components","_nativePromiseOnly","_utils","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","set","property","receiver","Reflect","base","_superPropBase","desc","getOwnPropertyDescriptor","call","_defineProperty","_set","isStrict","s","Error","_get","get","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","NestedComponent","_Field","_super","component","options","data","_this","type","_collapsed","collapsed","schema","components","uniqBy","getComponents","map","redraw","pristine","checkValidity","visibilityChanged","_visible","isVisible","visible","forceShow","show","forceHide","hide","forEach","parentVisible","conditionallyVisible","error","clearOnHide","_this2","disabled","parentDisabled","_this3","all","ready","currentForm","_rowIndex","eachComponent","rowIndex","componentContext","_data","_this4","everyComponent","fn","each","index","hasComponent","comp","flattenComponents","flattenAs","getComponent","path","originalPath","getStringFromComponentPath","getArrayFromComponentPath","pathStr","newPath","clone","shift","remainingPath","possibleComp","isNumber","isString","matchPath","hasInput","includes","getComponentById","id","calculateComponentPath","thisPath","allowData","parent","row","concat","Number","parseInt","_parentPath","shouldIncludeSubFormPath","createComponent","before","root","localRoot","skipInit","isInputComponent","init","internal","findIndex","splice","push","getContainer","element","addComponents","_this5","hook","componentComponents","addComponent","noAdd","parentPath","beforeFocus","render","children","renderTemplate","templateName","renderComponents","nestedKey","pdf","attach","_this6","superPromise","loadRefs","header","childPromise","resolve","refs","attachComponents","collapsible","addEventListener","keyCode","preventDefault","container","promises","Array","slice","child","getAttribute","removeComponent","destroy","remove","removeComponentByKey","_this7","removeComponentById","_this8","updateValue","flags","undefined","reduce","changed","shouldSkipValidation","dirty","input","checkData","builderMode","rootValue","isArray","isValid","valid","checkModal","isDirty","modalEdit","componentModal","messages","errors","clearErrorClasses","openModalWrapper","isPristine","level","message","t","setErrorClasses","openModal","checkConditions","hasValue","dataValue","defaultValue","restoreComponentsContext","_this9","beforePage","next","beforeSubmit","calculateValue","isLastPage","pages","page","silentCheck","checkCondition","setCustomValidity","check","checkAsyncValidity","_this10","then","results","setPristine","every","c","detach","clear","destroyComponents","_this11","thisErrors","filter","err","getValue","resetValue","dataReady","setNestedValue","setValue","rootPristine","noValidate","_this12","_len","extend","_key","tree"],"mappings":"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","sourcesContent":["'use strict';\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _Components = _interopRequireDefault(require(\"../../Components\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction set(target, property, value, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }\n\nfunction _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar NestedComponent = /*#__PURE__*/function (_Field) {\n  _inherits(NestedComponent, _Field);\n\n  var _super = _createSuper(NestedComponent);\n\n  function NestedComponent(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, NestedComponent);\n\n    _this = _super.call(this, component, options, data);\n    _this.type = 'components';\n    _this._collapsed = !!_this.component.collapsed;\n    return _this;\n  }\n\n  _createClass(NestedComponent, [{\n    key: \"defaultSchema\",\n    get: function get() {\n      return NestedComponent.schema();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = _get(_getPrototypeOf(NestedComponent.prototype), \"schema\", this);\n\n      var components = _lodash.default.uniqBy(this.getComponents(), 'component.key');\n\n      schema.components = _lodash.default.map(components, 'schema');\n      return schema;\n    }\n  }, {\n    key: \"collapsed\",\n    get: function get() {\n      return this._collapsed;\n    },\n    set: function set(value) {\n      this._collapsed = value;\n      this.redraw();\n\n      if (!value && !this.pristine) {\n        this.checkValidity(this.data, true);\n      }\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      // DO NOT CALL super here.  There is an issue where clearOnHide was getting triggered with\n      // subcomponents because the \"parentVisible\" flag was set to false when it should really be\n      // set to true.\n      var visibilityChanged = this._visible !== value;\n      this._visible = value;\n      var isVisible = this.visible;\n      var forceShow = this.options.show && this.options.show[this.component.key];\n      var forceHide = this.options.hide && this.options.hide[this.component.key];\n      this.components.forEach(function (component) {\n        // Set the parent visibility first since we may have nested components within nested components\n        // and they need to be able to determine their visibility based on the parent visibility.\n        component.parentVisible = isVisible;\n        var conditionallyVisible = component.conditionallyVisible();\n\n        if (forceShow || conditionallyVisible) {\n          component.visible = true;\n        } else if (forceHide || !isVisible || !conditionallyVisible) {\n          component.visible = false;\n        } // If hiding a nested component, clear all errors below.\n\n\n        if (!component.visible) {\n          component.error = '';\n        }\n      });\n\n      if (visibilityChanged) {\n        this.clearOnHide();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this2 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentVisible\", value, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentVisible = _this2.visible;\n      });\n    }\n  }, {\n    key: \"disabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"disabled\", this);\n    },\n    set: function set(disabled) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"disabled\", disabled, this, true);\n\n      this.components.forEach(function (component) {\n        return component.parentDisabled = disabled;\n      });\n    }\n  }, {\n    key: \"parentDisabled\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      _set(_getPrototypeOf(NestedComponent.prototype), \"parentDisabled\", value, this, true);\n\n      this.components.forEach(function (component) {\n        component.parentDisabled = _this3.disabled;\n      });\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.ready;\n      }));\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", this);\n    },\n    set: function set(instance) {\n      _set(_getPrototypeOf(NestedComponent.prototype), \"currentForm\", instance, this, true);\n\n      this.getComponents().forEach(function (component) {\n        component.currentForm = instance;\n      });\n    }\n  }, {\n    key: \"rowIndex\",\n    get: function get() {\n      return this._rowIndex;\n    },\n    set: function set(value) {\n      this._rowIndex = value;\n      this.eachComponent(function (component) {\n        component.rowIndex = value;\n      });\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return this._data;\n    },\n    set: function set(value) {\n      var _this4 = this;\n\n      this._data = value;\n      this.eachComponent(function (component) {\n        component.data = _this4.componentContext(component);\n      });\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.components || [];\n    }\n    /**\n     * Perform a deep iteration over every component, including those\n     * within other container based components.\n     *\n     * @param {function} fn - Called for every component.\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent(fn, options) {\n      var components = this.getComponents();\n\n      _lodash.default.each(components, function (component, index) {\n        if (fn(component, components, index) === false) {\n          return false;\n        }\n\n        if (typeof component.everyComponent === 'function') {\n          if (component.everyComponent(fn, options) === false) {\n            return false;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"hasComponent\",\n    value: function hasComponent(component) {\n      var result = false;\n      this.everyComponent(function (comp) {\n        if (comp === component) {\n          result = true;\n          return false;\n        }\n      });\n      return result;\n    }\n  }, {\n    key: \"flattenComponents\",\n    value: function flattenComponents() {\n      var result = {};\n      this.everyComponent(function (component) {\n        result[component.component.flattenAs || component.key] = component;\n      });\n      return result;\n    }\n    /**\n     * Perform an iteration over each component within this container component.\n     *\n     * @param {function} fn - Called for each component\n     */\n\n  }, {\n    key: \"eachComponent\",\n    value: function eachComponent(fn) {\n      _lodash.default.each(this.getComponents(), function (component, index) {\n        if (fn(component, index) === false) {\n          return false;\n        }\n      });\n    }\n    /**\n     * Returns a component provided a key. This performs a deep search within the\n     * component tree.\n     *\n     * @param {string} key - The key of the component to retrieve.\n     * @param {function} fn - Called with the component once found.\n     * @return {Object} - The component that is located.\n     */\n\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn, originalPath) {\n      originalPath = originalPath || (0, _utils.getStringFromComponentPath)(path);\n      path = (0, _utils.getArrayFromComponentPath)(path);\n      var pathStr = originalPath;\n\n      var newPath = _lodash.default.clone(path);\n\n      var key = newPath.shift();\n      var remainingPath = newPath;\n      var comp = null;\n      var possibleComp = null;\n\n      if (_lodash.default.isNumber(key)) {\n        key = remainingPath.shift();\n      }\n\n      if (!_lodash.default.isString(key)) {\n        return comp;\n      }\n\n      this.everyComponent(function (component, components) {\n        var matchPath = component.hasInput && component.path ? pathStr.includes(component.path) : true;\n\n        if (component.component.key === key) {\n          possibleComp = component;\n\n          if (matchPath) {\n            comp = component;\n\n            if (remainingPath.length > 0 && 'getComponent' in component) {\n              comp = component.getComponent(remainingPath, fn, originalPath);\n            } else if (fn) {\n              fn(component, components);\n            }\n\n            return false;\n          }\n        }\n      });\n\n      if (!comp) {\n        comp = possibleComp;\n      }\n\n      return comp;\n    }\n    /**\n     * Return a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component.\n     * @param {function} fn - Called with the component once it is retrieved.\n     * @return {Object} - The component retrieved.\n     */\n\n  }, {\n    key: \"getComponentById\",\n    value: function getComponentById(id, fn) {\n      var comp = null;\n      this.everyComponent(function (component, components) {\n        if (component.id === id) {\n          comp = component;\n\n          if (fn) {\n            fn(component, components);\n          }\n\n          return false;\n        }\n      });\n      return comp;\n    }\n    /**\n     * Return a path of component's value.\n     *\n     * @param {Object} component - The component instance.\n     * @return {string} - The component's value path.\n     */\n\n  }, {\n    key: \"calculateComponentPath\",\n    value: function calculateComponentPath(component) {\n      var path = '';\n\n      if (component.component.key) {\n        var thisPath = this;\n\n        while (thisPath && !thisPath.allowData && thisPath.parent) {\n          thisPath = thisPath.parent;\n        }\n\n        var rowIndex = component.row ? \"[\".concat(Number.parseInt(component.row), \"]\") : '';\n        path = thisPath.path ? \"\".concat(thisPath.path).concat(rowIndex, \".\") : '';\n        path += component._parentPath && component.component.shouldIncludeSubFormPath ? component._parentPath : '';\n        path += component.component.key;\n        return path;\n      }\n    }\n    /**\n     * Create a new component and add it to the components array.\n     *\n     * @param component\n     * @param data\n     */\n\n  }, {\n    key: \"createComponent\",\n    value: function createComponent(component, options, data, before) {\n      if (!component) {\n        return;\n      }\n\n      options = options || this.options;\n      data = data || this.data;\n      options.parent = this;\n      options.parentVisible = this.visible;\n      options.root = this.root || this;\n      options.localRoot = this.localRoot;\n      options.skipInit = true;\n\n      if (!this.isInputComponent && this.component.shouldIncludeSubFormPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      var comp = _Components.default.create(component, options, data, true);\n\n      var path = this.calculateComponentPath(comp);\n\n      if (path) {\n        comp.path = path;\n      }\n\n      comp.init();\n\n      if (component.internal) {\n        return comp;\n      }\n\n      if (before) {\n        var index = _lodash.default.findIndex(this.components, {\n          id: before.id\n        });\n\n        if (index !== -1) {\n          this.components.splice(index, 0, comp);\n        } else {\n          this.components.push(comp);\n        }\n      } else {\n        this.components.push(comp);\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return this.element;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.component.components || [];\n    }\n  }, {\n    key: \"nestedKey\",\n    get: function get() {\n      return \"nested-\".concat(this.key);\n    }\n  }, {\n    key: \"templateName\",\n    get: function get() {\n      return 'container';\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.components = this.components || [];\n      this.addComponents();\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"init\", this).call(this);\n    }\n    /**\n     *\n     * @param element\n     * @param data\n     */\n\n  }, {\n    key: \"addComponents\",\n    value: function addComponents(data, options) {\n      var _this5 = this;\n\n      data = data || this.data;\n      options = options || this.options;\n\n      if (options.components) {\n        this.components = options.components;\n      } else {\n        var components = this.hook('addComponents', this.componentComponents, this) || [];\n        components.forEach(function (component) {\n          return _this5.addComponent(component, data);\n        });\n      }\n    }\n    /**\n     * Add a new component to the components array.\n     *\n     * @param {Object} component - The component JSON schema to add.\n     * @param {Object} data - The submission data object to house the data for this component.\n     * @param {HTMLElement} before - A DOM element to insert this element before.\n     * @return {Component} - The created component instance.\n     */\n\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(component, data, before, noAdd) {\n      data = data || this.data;\n\n      if (this.options.parentPath) {\n        component.shouldIncludeSubFormPath = true;\n      }\n\n      component = this.hook('addComponent', component, data, before, noAdd);\n      var comp = this.createComponent(component, this.options, data, before ? before : null);\n\n      if (noAdd) {\n        return comp;\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"beforeFocus\",\n    value: function beforeFocus() {\n      if (this.parent && 'beforeFocus' in this.parent) {\n        this.parent.beforeFocus(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(children) {\n      // If already rendering, don't re-render.\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"render\", this).call(this, children || this.renderTemplate(this.templateName, {\n        children: this.renderComponents(),\n        nestedKey: this.nestedKey,\n        collapsed: this.options.pdf ? false : this.collapsed\n      }));\n    }\n  }, {\n    key: \"renderComponents\",\n    value: function renderComponents(components) {\n      components = components || this.getComponents();\n      var children = components.map(function (component) {\n        return component.render();\n      });\n      return this.renderTemplate('components', {\n        children: children,\n        components: components\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this6 = this;\n\n      var superPromise = _get(_getPrototypeOf(NestedComponent.prototype), \"attach\", this).call(this, element);\n\n      this.loadRefs(element, _defineProperty({\n        header: 'single',\n        collapsed: this.collapsed\n      }, this.nestedKey, 'single'));\n\n      var childPromise = _nativePromiseOnly.default.resolve();\n\n      if (this.refs[this.nestedKey]) {\n        childPromise = this.attachComponents(this.refs[this.nestedKey]);\n      }\n\n      if (this.component.collapsible && this.refs.header) {\n        this.addEventListener(this.refs.header, 'click', function () {\n          _this6.collapsed = !_this6.collapsed;\n        });\n        this.addEventListener(this.refs.header, 'keydown', function (e) {\n          if (e.keyCode === 13 || e.keyCode === 32) {\n            e.preventDefault();\n            _this6.collapsed = !_this6.collapsed;\n          }\n        });\n      }\n\n      return _nativePromiseOnly.default.all([superPromise, childPromise]);\n    }\n  }, {\n    key: \"attachComponents\",\n    value: function attachComponents(element, components, container) {\n      components = components || this.components;\n      container = container || this.component.components;\n      element = this.hook('attachComponents', element, components, container, this);\n\n      if (!element) {\n        // Return a non-resolving promise.\n        return new _nativePromiseOnly.default(function () {});\n      }\n\n      var index = 0;\n      var promises = [];\n      Array.prototype.slice.call(element.children).forEach(function (child) {\n        if (!child.getAttribute('data-noattach') && components[index]) {\n          promises.push(components[index].attach(child));\n          index++;\n        }\n      });\n      return _nativePromiseOnly.default.all(promises);\n    }\n    /**\n     * Remove a component from the components array.\n     *\n     * @param {Component} component - The component to remove from the components.\n     * @param {Array<Component>} components - An array of components to remove this component from.\n     */\n\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, components) {\n      components = components || this.components;\n      component.destroy();\n\n      _lodash.default.remove(components, {\n        id: component.id\n      });\n    }\n    /**\n     * Removes a component provided the API key of that component.\n     *\n     * @param {string} key - The API key of the component to remove.\n     * @param {function} fn - Called once the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentByKey\",\n    value: function removeComponentByKey(key, fn) {\n      var _this7 = this;\n\n      var comp = this.getComponent(key, function (component, components) {\n        _this7.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n    /**\n     * Removes a component provided the Id of the component.\n     *\n     * @param {string} id - The Id of the component to remove.\n     * @param {function} fn - Called when the component is removed.\n     * @return {null}\n     */\n\n  }, {\n    key: \"removeComponentById\",\n    value: function removeComponentById(id, fn) {\n      var _this8 = this;\n\n      var comp = this.getComponentById(id, function (component, components) {\n        _this8.removeComponent(component, components);\n\n        if (fn) {\n          fn(component, components);\n        }\n      });\n\n      if (!comp) {\n        if (fn) {\n          fn(null);\n        }\n\n        return null;\n      }\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(value) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this.components.reduce(function (changed, comp) {\n        return comp.updateValue(null, flags) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"updateValue\", this).call(this, value, flags));\n    }\n  }, {\n    key: \"shouldSkipValidation\",\n    value: function shouldSkipValidation(data, dirty, row) {\n      // Nested components with no input should not be validated.\n      if (!this.component.input) {\n        return true;\n      } else {\n        return _get(_getPrototypeOf(NestedComponent.prototype), \"shouldSkipValidation\", this).call(this, data, dirty, row);\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data, flags, row, components) {\n      if (this.builderMode) {\n        return true;\n      }\n\n      data = data || this.rootValue;\n      flags = flags || {};\n      row = row || this.data;\n      components = components && _lodash.default.isArray(components) ? components : this.getComponents();\n      var isValid = components.reduce(function (valid, comp) {\n        return comp.checkData(data, flags, row) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkData\", this).call(this, data, flags, row));\n      this.checkModal(isValid, this.isDirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkModal\",\n    value: function checkModal(isValid, dirty) {\n      if (!this.component.modalEdit || !this.componentModal) {\n        return;\n      }\n\n      var messages = this.errors;\n      this.clearErrorClasses(this.refs.openModalWrapper);\n      this.error = '';\n\n      if (!isValid && (dirty || !this.isPristine && !!messages.length)) {\n        this.error = {\n          component: this.component,\n          level: 'hidden',\n          message: this.t('Fix the errors'),\n          messages: messages\n        };\n        this.setErrorClasses([this.refs.openModal], dirty, !isValid, !!messages.length, this.refs.openModalWrapper);\n      }\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      this.getComponents().forEach(function (comp) {\n        return comp.checkConditions(data, flags, row);\n      });\n      return _get(_getPrototypeOf(NestedComponent.prototype), \"checkConditions\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"clearOnHide\",\n    value: function clearOnHide(show) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clearOnHide\", this).call(this, show);\n\n      if (this.component.clearOnHide) {\n        if (this.allowData && !this.hasValue()) {\n          this.dataValue = this.defaultValue;\n        }\n\n        if (this.hasValue()) {\n          this.restoreComponentsContext();\n        }\n      }\n\n      this.getComponents().forEach(function (component) {\n        return component.clearOnHide(show);\n      });\n    }\n  }, {\n    key: \"restoreComponentsContext\",\n    value: function restoreComponentsContext() {\n      var _this9 = this;\n\n      this.getComponents().forEach(function (component) {\n        return component.data = _this9.dataValue;\n      });\n    }\n    /**\n     * Allow components to hook into the next page trigger to perform their own logic.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforePage(next);\n      }));\n    }\n    /**\n     * Allow components to hook into the submission to provide their own async data.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (comp) {\n        return comp.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      // Do not iterate into children and calculateValues if this nested component is conditionally hidden.\n      if (!this.conditionallyVisible()) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, comp) {\n        return comp.calculateValue(data, flags, row) || changed;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"calculateValue\", this).call(this, data, flags, row));\n    }\n  }, {\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      return this.pages.length - 1 === this.page;\n    }\n  }, {\n    key: \"isValid\",\n    value: function isValid(data, dirty) {\n      return this.getComponents().reduce(function (valid, comp) {\n        return comp.isValid(data, dirty) && valid;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"isValid\", this).call(this, data, dirty));\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, silentCheck) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var isValid = this.getComponents().reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row, silentCheck) && check;\n      }, _get(_getPrototypeOf(NestedComponent.prototype), \"checkValidity\", this).call(this, data, dirty, row, silentCheck));\n      this.checkModal(isValid, dirty);\n      return isValid;\n    }\n  }, {\n    key: \"checkAsyncValidity\",\n    value: function checkAsyncValidity(data, dirty, row, silentCheck) {\n      var _this10 = this;\n\n      return this.ready.then(function () {\n        var promises = [_get(_getPrototypeOf(NestedComponent.prototype), \"checkAsyncValidity\", _this10).call(_this10, data, dirty, row, silentCheck)];\n\n        _this10.eachComponent(function (component) {\n          return promises.push(component.checkAsyncValidity(data, dirty, row, silentCheck));\n        });\n\n        return _nativePromiseOnly.default.all(promises).then(function (results) {\n          return results.reduce(function (valid, result) {\n            return valid && result;\n          }, true);\n        });\n      });\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.setPristine(pristine);\n      });\n    }\n  }, {\n    key: \"isPristine\",\n    get: function get() {\n      return this.pristine && this.getComponents().every(function (c) {\n        return c.isPristine;\n      });\n    }\n  }, {\n    key: \"isDirty\",\n    get: function get() {\n      return this.dirty && this.getComponents().every(function (c) {\n        return c.isDirty;\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      this.components.forEach(function (component) {\n        component.detach();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.components.forEach(function (component) {\n        component.clear();\n      });\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"clear\", this).call(this);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.destroyComponents();\n\n      _get(_getPrototypeOf(NestedComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"destroyComponents\",\n    value: function destroyComponents() {\n      var _this11 = this;\n\n      var components = this.getComponents().slice();\n      components.forEach(function (comp) {\n        return _this11.removeComponent(comp, _this11.components);\n      });\n      this.components = [];\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var thisErrors = this.error ? [this.error] : [];\n      return this.getComponents().reduce(function (errors, comp) {\n        return errors.concat(comp.errors || []);\n      }, thisErrors).filter(function (err) {\n        return err.level !== 'hidden';\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      return this.data;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _get(_getPrototypeOf(NestedComponent.prototype), \"resetValue\", this).call(this);\n\n      this.getComponents().forEach(function (comp) {\n        return comp.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return _nativePromiseOnly.default.all(this.getComponents().map(function (component) {\n        return component.dataReady;\n      }));\n    }\n  }, {\n    key: \"setNestedValue\",\n    value: function setNestedValue(component, value) {\n      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      component._data = this.componentContext(component);\n\n      if (component.type === 'button') {\n        return false;\n      }\n\n      if (component.type === 'components') {\n        return component.setValue(value, flags);\n      } else if (value && component.hasValue(value)) {\n        return component.setValue(_lodash.default.get(value, component.key), flags);\n      } else if (!this.rootPristine || component.visible) {\n        flags.noValidate = !flags.dirty;\n        flags.resetValue = true;\n        return component.setValue(component.defaultValue, flags);\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var _this12 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!value) {\n        return false;\n      }\n\n      return this.getComponents().reduce(function (changed, component) {\n        return _this12.setNestedValue(component, value, flags, changed) || changed;\n      }, false);\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len = arguments.length, extend = new Array(_len), _key = 0; _key < _len; _key++) {\n        extend[_key] = arguments[_key];\n      }\n\n      return _Field2.default.schema.apply(_Field2.default, [{\n        tree: false\n      }].concat(extend));\n    }\n  }]);\n\n  return NestedComponent;\n}(_Field2.default);\n\nexports.default = NestedComponent;"]},"metadata":{},"sourceType":"script"}