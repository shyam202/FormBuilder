{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Component2 = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../_classes/componentModal/ComponentModal\"));\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _Formio = _interopRequireDefault(require(\"../../Formio\"));\n\nvar _Form = _interopRequireDefault(require(\"../../Form\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar FormComponent = /*#__PURE__*/function (_Component) {\n  _inherits(FormComponent, _Component);\n\n  var _super = _createSuper(FormComponent);\n\n  function FormComponent() {\n    _classCallCheck(this, FormComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FormComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"init\", this).call(this);\n\n      this.formObj = {\n        display: this.component.display,\n        settings: this.component.settings,\n        components: this.component.components\n      };\n      this.valueChanged = false;\n      this.subForm = null;\n      this.formSrc = '';\n\n      if (this.component.src) {\n        this.formSrc = this.component.src;\n      }\n\n      if (!this.component.src && !this.options.formio && (this.component.form || this.component.path)) {\n        if (this.component.project) {\n          this.formSrc = _Formio.default.getBaseUrl(); // Check to see if it is a MongoID.\n\n          if ((0, _utils.isMongoId)(this.component.project)) {\n            this.formSrc += '/project';\n          }\n\n          this.formSrc += \"/\".concat(this.component.project);\n          this.options.project = this.formSrc;\n        } else {\n          this.formSrc = _Formio.default.getProjectUrl();\n          this.options.project = this.formSrc;\n        }\n\n        if (this.component.form) {\n          this.formSrc += \"/form/\".concat(this.component.form);\n        } else if (this.component.path) {\n          this.formSrc += \"/\".concat(this.component.path);\n        }\n      } // Build the source based on the root src path.\n\n\n      if (!this.formSrc && this.options.formio) {\n        var rootSrc = this.options.formio.formsUrl;\n\n        if (this.component.path) {\n          var parts = rootSrc.split('/');\n          parts.pop();\n          this.formSrc = \"\".concat(parts.join('/'), \"/\").concat(this.component.path);\n        }\n\n        if (this.component.form) {\n          this.formSrc = \"\".concat(rootSrc, \"/\").concat(this.component.form);\n        }\n      }\n\n      if (this.builderMode && this.component.hasOwnProperty('formRevision')) {\n        this.component.revision = this.component.formRevision;\n        delete this.component.formRevision;\n      } // Add revision version if set.\n\n\n      if (this.component.revision || this.component.revision === 0 || this.component.formRevision || this.component.formRevision === 0) {\n        this.setFormRevision(this.component.revision || this.component.formRevision);\n      }\n\n      return this.createSubForm();\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      // Not not provide a default value unless the subform is ready so that it will initialize correctly.\n      return this.subForm ? _get(_getPrototypeOf(FormComponent.prototype), \"defaultValue\", this) : null;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return FormComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return {\n        data: {}\n      };\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"useOriginalRevision\",\n    get: function get() {\n      var _this$component, _this$formObj;\n\n      return ((_this$component = this.component) === null || _this$component === void 0 ? void 0 : _this$component.useOriginalRevision) && !!((_this$formObj = this.formObj) !== null && _this$formObj !== void 0 && _this$formObj.revisions);\n    }\n  }, {\n    key: \"setFormRevision\",\n    value: function setFormRevision(rev) {\n      // Remove current revisions from src if it is\n      this.formSrc = this.formSrc.replace(/\\/v\\/\\d*/, '');\n      var revNumber = Number.parseInt(rev);\n\n      if (!isNaN(revNumber)) {\n        this.subFormRevision = rev;\n        this.formSrc += \"/v/\".concat(rev);\n      } else {\n        this.subFormRevision = undefined;\n      }\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn) {\n      path = (0, _utils.getArrayFromComponentPath)(path);\n\n      if (path[0] === 'data') {\n        path.shift();\n      }\n\n      var originalPathStr = \"\".concat(this.path, \".data.\").concat((0, _utils.getStringFromComponentPath)(path));\n\n      if (this.subForm) {\n        return this.subForm.getComponent(path, fn, originalPathStr);\n      }\n    }\n  }, {\n    key: \"getSubOptions\",\n    value: function getSubOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      options.parentPath = \"\".concat(this.path, \".data.\");\n      options.events = this.createEmitter(); // Make sure to not show the submit button in wizards in the nested forms.\n\n      _lodash.default.set(options, 'buttonSettings.showSubmit', false);\n\n      if (!this.options) {\n        return options;\n      }\n\n      if (this.options.base) {\n        options.base = this.options.base;\n      }\n\n      if (this.options.project) {\n        options.project = this.options.project;\n      }\n\n      if (this.options.readOnly || this.component.disabled) {\n        options.readOnly = this.options.readOnly || this.component.disabled;\n      }\n\n      if (this.options.breadcrumbSettings) {\n        options.breadcrumbSettings = this.options.breadcrumbSettings;\n      }\n\n      if (this.options.buttonSettings) {\n        options.buttonSettings = _lodash.default.clone(this.options.buttonSettings);\n      }\n\n      if (this.options.viewAsHtml) {\n        options.viewAsHtml = this.options.viewAsHtml;\n      }\n\n      if (this.options.language) {\n        options.language = this.options.language;\n      }\n\n      if (this.options.template) {\n        options.template = this.options.template;\n      }\n\n      if (this.options.templates) {\n        options.templates = this.options.templates;\n      }\n\n      if (this.options.renderMode) {\n        options.renderMode = this.options.renderMode;\n      }\n\n      if (this.options.attachMode) {\n        options.attachMode = this.options.attachMode;\n      }\n\n      if (this.options.iconset) {\n        options.iconset = this.options.iconset;\n      }\n\n      if (this.options.fileService) {\n        options.fileService = this.options.fileService;\n      }\n\n      if (this.options.onChange) {\n        options.onChange = this.options.onChange;\n      }\n\n      return options;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, this.component.label || 'Nested form');\n      }\n\n      var subform = this.subForm ? this.subForm.render() : this.renderTemplate('loading');\n      return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, subform);\n    }\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      return this.getValueAsString(value);\n    }\n    /**\n     * Prints out the value of form components as a datagrid value.\n     */\n\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value) {\n      if (!value) {\n        return 'No data provided';\n      }\n\n      if (!value.data && value._id) {\n        return value._id;\n      }\n\n      if (!value.data || !Object.keys(value.data).length) {\n        return 'No data provided';\n      }\n\n      return '[Complex Data]';\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this = this; // Don't attach in builder.\n\n\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element).then(function () {\n        if (_this.isSubFormLazyLoad() && !_this.hasLoadedForm && !_this.subFormLoading) {\n          _this.createSubForm(true);\n        }\n\n        return _this.subFormReady.then(function () {\n          _this.empty(element);\n\n          if (_this.options.builder) {\n            _this.setContent(element, _this.ce('div', {\n              class: 'text-muted text-center p-2'\n            }, _this.text(_this.formObj.title)));\n\n            return;\n          }\n\n          _this.setContent(element, _this.render());\n\n          if (_this.subForm) {\n            if (_this.isNestedWizard) {\n              element = _this.root.element;\n            }\n\n            _this.subForm.attach(element);\n\n            _this.valueChanged = _this.hasSetValue;\n\n            if (!_this.valueChanged && _this.dataValue.state !== 'submitted') {\n              _this.setDefaultValue();\n            } else {\n              _this.restoreValue();\n            }\n          }\n\n          if (!_this.builderMode && _this.component.modalEdit) {\n            var modalShouldBeOpened = _this.componentModal ? _this.componentModal.isOpened : false;\n            var currentValue = modalShouldBeOpened ? _this.componentModal.currentValue : _this.dataValue;\n            _this.componentModal = new _ComponentModal.default(_this, element, modalShouldBeOpened, currentValue);\n\n            _this.setOpenModalElement();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.subForm) {\n        this.subForm.detach();\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      var _this2 = this;\n\n      this._currentForm = instance;\n\n      if (!this.subForm) {\n        return;\n      }\n\n      this.subForm.getComponents().forEach(function (component) {\n        component.currentForm = _this2;\n      });\n    }\n  }, {\n    key: \"hasLoadedForm\",\n    get: function get() {\n      return this.formObj && this.formObj.components && Array.isArray(this.formObj.components) && this.formObj.components.length;\n    }\n  }, {\n    key: \"isRevisionChanged\",\n    get: function get() {\n      return _lodash.default.isNumber(this.subFormRevision) && _lodash.default.isNumber(this.formObj._vid) && this.formObj._vid !== this.subFormRevision;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.subForm) {\n        this.subForm.destroy();\n        this.subForm = null;\n        this.subFormReady = null;\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      if (this.subForm) {\n        this.subForm.form = this.formObj;\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"redraw\", this).call(this);\n    }\n    /**\n     * Pass everyComponent to subform.\n     * @param args\n     * @returns {*|void}\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent() {\n      if (this.subForm) {\n        var _this$subForm;\n\n        (_this$subForm = this.subForm).everyComponent.apply(_this$subForm, arguments);\n      }\n    }\n  }, {\n    key: \"updateSubWizards\",\n    value: function updateSubWizards(subForm) {\n      var _this$root,\n          _subForm$_form,\n          _this3 = this;\n\n      if (this.isNestedWizard && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.subWizards && (subForm === null || subForm === void 0 ? void 0 : (_subForm$_form = subForm._form) === null || _subForm$_form === void 0 ? void 0 : _subForm$_form.display) === 'wizard') {\n        var existedForm = this.root.subWizards.findIndex(function (form) {\n          return form.component.form === _this3.component.form;\n        });\n\n        if (existedForm !== -1) {\n          this.root.subWizards[existedForm] = this;\n        } else {\n          this.root.subWizards.push(this);\n        }\n\n        this.emit('subWizardsUpdated', subForm);\n      }\n    }\n    /**\n     * Create a subform instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"createSubForm\",\n    value: function createSubForm(fromAttach) {\n      var _this4 = this;\n\n      this.subFormReady = this.loadSubForm(fromAttach).then(function (form) {\n        if (!form) {\n          return;\n        } // Iterate through every component and hide the submit button.\n\n\n        (0, _utils.eachComponent)(form.components, function (component) {\n          _this4.hideSubmitButton(component);\n        }); // If the subform is already created then destroy the old one.\n\n        if (_this4.subForm) {\n          _this4.subForm.destroy();\n        } // Render the form.\n\n\n        return new _Form.default(form, _this4.getSubOptions()).ready.then(function (instance) {\n          _this4.subForm = instance;\n          _this4.subForm.currentForm = _this4;\n          _this4.subForm.parent = _this4;\n          _this4.subForm.parentVisible = _this4.visible;\n\n          _this4.subForm.on('change', function () {\n            if (_this4.subForm) {\n              _this4.dataValue = _this4.subForm.getValue();\n\n              _this4.triggerChange({\n                noEmit: true\n              });\n            }\n          });\n\n          _this4.subForm.url = _this4.formSrc;\n          _this4.subForm.nosubmit = true;\n          _this4.subForm.root = _this4.root;\n          _this4.subForm.localRoot = _this4.isNestedWizard ? _this4.localRoot : _this4.subForm;\n\n          _this4.restoreValue();\n\n          _this4.valueChanged = _this4.hasSetValue;\n          return _this4.subForm;\n        });\n      }).then(function (subForm) {\n        _this4.updateSubWizards(subForm);\n\n        return subForm;\n      });\n      return this.subFormReady;\n    }\n  }, {\n    key: \"hideSubmitButton\",\n    value: function hideSubmitButton(component) {\n      var isSubmitButton = component.type === 'button' && (component.action === 'submit' || !component.action);\n\n      if (isSubmitButton) {\n        component.hidden = true;\n      }\n    }\n    /**\n     * Load the subform.\n     */\n\n  }, {\n    key: \"loadSubForm\",\n    value: function loadSubForm(fromAttach) {\n      var _this5 = this;\n\n      if (this.builderMode || this.isHidden() || this.isSubFormLazyLoad() && !fromAttach) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (this.hasLoadedForm && !this.isRevisionChanged) {\n        // Pass config down to sub forms.\n        if (this.root && this.root.form && this.root.form.config && !this.formObj.config) {\n          this.formObj.config = this.root.form.config;\n        }\n\n        return _nativePromiseOnly.default.resolve(this.formObj);\n      } else if (this.formSrc) {\n        this.subFormLoading = true;\n        return new _Formio.default(this.formSrc).loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (formObj) {\n          _this5.formObj = formObj;\n          _this5.subFormLoading = false;\n          return formObj;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      options = options || {};\n      var silentCheck = options.silentCheck || false;\n\n      if (this.subForm) {\n        return this.subForm.checkValidity(this.dataValue.data, dirty, null, silentCheck);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options);\n    }\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      var _this6 = this;\n\n      var visible = _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentConditions\", this).call(this, data, flags, row); // Return if already hidden\n\n\n      if (!visible) {\n        return visible;\n      }\n\n      if (this.subForm) {\n        return this.subForm.checkConditions(this.dataValue.data);\n      } // There are few cases when subForm is not loaded when a change is triggered,\n      // so we need to perform checkConditions after it is ready, or some conditional fields might be hidden in View mode\n      else if (this.subFormReady) {\n          this.subFormReady.then(function () {\n            if (_this6.subForm) {\n              return _this6.subForm.checkConditions(_this6.dataValue.data);\n            }\n          });\n        }\n\n      return visible;\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      if (this.subForm) {\n        return this.subForm.calculateValue(this.dataValue.data, flags);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"calculateValue\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      if (this.subForm) {\n        this.subForm.setPristine(pristine);\n      }\n    }\n    /**\n     * Determine if the subform should be submitted.\n     * @return {*|boolean}\n     */\n\n  }, {\n    key: \"shouldSubmit\",\n    get: function get() {\n      return this.subFormReady && (!this.component.hasOwnProperty('reference') || this.component.reference) && !this.isHidden();\n    }\n    /**\n     * Returns the data for the subform.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getSubFormData\",\n    value: function getSubFormData() {\n      if (_lodash.default.get(this.subForm, 'form.display') === 'pdf') {\n        return this.subForm.getSubmission();\n      } else {\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n    }\n    /**\n     * Submit the subform if configured to do so.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submitSubForm\",\n    value: function submitSubForm(rejectOnError) {\n      var _this7 = this; // If we wish to submit the form on next page, then do that here.\n\n\n      if (this.shouldSubmit) {\n        return this.subFormReady.then(function () {\n          if (!_this7.subForm) {\n            return _this7.dataValue;\n          }\n\n          _this7.subForm.nosubmit = false;\n          return _this7.subForm.submitForm().then(function (result) {\n            _this7.subForm.loading = false;\n            _this7.subForm.showAllErrors = false;\n            _this7.dataValue = result.submission;\n            return _this7.dataValue;\n          }).catch(function (err) {\n            _this7.subForm.showAllErrors = true;\n\n            if (rejectOnError) {\n              _this7.subForm.onSubmissionError(err);\n\n              return _nativePromiseOnly.default.reject(err);\n            } else {\n              return {};\n            }\n          });\n        });\n      }\n\n      return this.getSubFormData();\n    }\n    /**\n     * Submit the form before the next page is triggered.\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this8 = this; // Should not submit child forms if we are going to the previous page\n\n\n      if (!next) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", this).call(this, next);\n      }\n\n      return this.submitSubForm(true).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", _this8).call(_this8, next);\n      });\n    }\n    /**\n     * Submit the form before the whole form is triggered.\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var _this$subForm2,\n          _this9 = this;\n\n      var submission = this.dataValue;\n      var isAlreadySubmitted = submission && submission._id && submission.form; // This submission has already been submitted, so just return the reference data.\n\n      if (isAlreadySubmitted && !((_this$subForm2 = this.subForm) !== null && _this$subForm2 !== void 0 && _this$subForm2.wizard)) {\n        this.dataValue = submission;\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n\n      return this.submitSubForm(false).then(function () {\n        return _this9.dataValue;\n      }).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforeSubmit\", _this9).call(_this9);\n      });\n    }\n  }, {\n    key: \"isSubFormLazyLoad\",\n    value: function isSubFormLazyLoad() {\n      var _this$root2, _this$root2$_form;\n\n      return ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$_form = _this$root2._form) === null || _this$root2$_form === void 0 ? void 0 : _this$root2$_form.display) === 'wizard' && this.component.lazyLoad;\n    }\n  }, {\n    key: \"isHidden\",\n    value: function isHidden() {\n      if (!this.visible) {\n        return true;\n      }\n\n      return !_get(_getPrototypeOf(FormComponent.prototype), \"checkConditions\", this).call(this, this.rootValue);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this10 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var changed = _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, submission, flags);\n\n      this.valueChanged = true;\n\n      if (this.subForm) {\n        var _this$subForm$form;\n\n        var shouldLoadOriginalRevision = this.useOriginalRevision && _lodash.default.isNumber(submission._fvid) && _lodash.default.isNumber((_this$subForm$form = this.subForm.form) === null || _this$subForm$form === void 0 ? void 0 : _this$subForm$form._vid) && submission._fvid !== this.subForm.form._vid;\n\n        if (shouldLoadOriginalRevision) {\n          this.setFormRevision(submission._fvid);\n          this.createSubForm().then(function () {\n            _this10.attach(_this10.element);\n          });\n        } else {\n          this.setSubFormValue(submission, flags);\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"setSubFormValue\",\n    value: function setSubFormValue(submission, flags) {\n      var shouldLoadSubmissionById = submission && submission._id && this.subForm.formio && _lodash.default.isEmpty(submission.data);\n\n      if (shouldLoadSubmissionById) {\n        var formId = submission.form || this.formObj.form || this.component.form;\n        var submissionUrl = \"\".concat(this.subForm.formio.formsUrl, \"/\").concat(formId, \"/submission/\").concat(submission._id);\n        this.subForm.setUrl(submissionUrl, this.options);\n        this.subForm.loadSubmission();\n      } else {\n        this.subForm.setValue(submission, flags);\n      }\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return value === null || _lodash.default.isEqual(value, this.emptyValue) || this.areAllComponentsEmpty(value.data) && !value._id;\n    }\n  }, {\n    key: \"areAllComponentsEmpty\",\n    value: function areAllComponentsEmpty(data) {\n      var res = true;\n\n      if (this.subForm) {\n        this.subForm.everyComponent(function (comp) {\n          var componentValue = _lodash.default.get(data, comp.key);\n\n          res &= comp.isEmpty(componentValue);\n        });\n      } else {\n        res = false;\n      }\n\n      return res;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.subForm) {\n        return this.subForm.getValue();\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var errors = _get(_getPrototypeOf(FormComponent.prototype), \"errors\", this);\n\n      if (this.subForm) {\n        errors = errors.concat(this.subForm.errors);\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"updateSubFormVisibility\",\n    value: function updateSubFormVisibility() {\n      if (this.subForm) {\n        this.subForm.parentVisible = this.visible;\n      }\n    }\n    /**\n     * Determines if this form is a Nested Wizard\n     * which means it should be a Wizard itself and should be a direct child of a Wizard's page\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isNestedWizard\",\n    get: function get() {\n      var _this$subForm3, _this$subForm3$_form, _this$parent, _this$parent$parent, _this$parent$parent$_;\n\n      return ((_this$subForm3 = this.subForm) === null || _this$subForm3 === void 0 ? void 0 : (_this$subForm3$_form = _this$subForm3._form) === null || _this$subForm3$_form === void 0 ? void 0 : _this$subForm3$_form.display) === 'wizard' && ((_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : (_this$parent$parent = _this$parent.parent) === null || _this$parent$parent === void 0 ? void 0 : (_this$parent$parent$_ = _this$parent$parent._form) === null || _this$parent$parent$_ === void 0 ? void 0 : _this$parent$parent$_.display) === 'wizard';\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      var _this11 = this;\n\n      var isNestedWizard = this.isNestedWizard;\n\n      if (this._visible !== value) {\n        this._visible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this11.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        isNestedWizard ? this.rebuild() : this.redraw();\n      }\n\n      if (!value && isNestedWizard) {\n        this.root.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this12 = this;\n\n      if (this._parentVisible !== value) {\n        this._parentVisible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this12.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"isInternalEvent\",\n    value: function isInternalEvent(event) {\n      switch (event) {\n        case 'focus':\n        case 'blur':\n        case 'componentChange':\n        case 'componentError':\n        case 'error':\n        case 'formLoad':\n        case 'languageChanged':\n        case 'render':\n        case 'checkValidity':\n        case 'initialized':\n        case 'submit':\n        case 'submitButton':\n        case 'nosubmit':\n        case 'updateComponent':\n        case 'submitDone':\n        case 'submissionDeleted':\n        case 'requestDone':\n        case 'nextPage':\n        case 'prevPage':\n        case 'wizardNavigationClicked':\n        case 'updateWizardNav':\n        case 'restoreDraft':\n        case 'saveDraft':\n        case 'saveComponent':\n        case 'pdfUploaded':\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"createEmitter\",\n    value: function createEmitter() {\n      var emitter = new _eventemitter.default();\n      var nativeEmit = emitter.emit;\n      var that = this;\n\n      emitter.emit = function (event) {\n        var eventType = event.replace(\"\".concat(that.options.namespace, \".\"), '');\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        nativeEmit.call.apply(nativeEmit, [this, event].concat(args));\n\n        if (!that.isInternalEvent(eventType)) {\n          that.emit.apply(that, [eventType].concat(args));\n        }\n      };\n\n      return emitter;\n    }\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n\n      this.unset();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _Component2.default.schema.apply(_Component2.default, [{\n        label: 'Form',\n        type: 'form',\n        key: 'form',\n        src: '',\n        reference: true,\n        form: '',\n        path: '',\n        tableView: true\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Nested Form',\n        icon: 'wpforms',\n        group: 'premium',\n        documentation: '/userguide/#form',\n        weight: 110,\n        schema: FormComponent.schema()\n      };\n    }\n  }]);\n\n  return FormComponent;\n}(_Component2.default);\n\nexports.default = FormComponent;","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/formiojs/components/form/Form.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","require","_Component2","_ComponentModal","_eventemitter","_nativePromiseOnly","_utils","_Formio","_Form","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","FormComponent","_Component","_super","init","formObj","display","component","settings","components","valueChanged","subForm","formSrc","src","options","formio","form","path","project","getBaseUrl","isMongoId","concat","getProjectUrl","rootSrc","formsUrl","parts","split","pop","join","builderMode","revision","formRevision","setFormRevision","createSubForm","subFormReady","resolve","schema","data","_this$component","_this$formObj","useOriginalRevision","revisions","rev","replace","revNumber","Number","parseInt","isNaN","subFormRevision","undefined","getComponent","fn","getArrayFromComponentPath","shift","originalPathStr","getStringFromComponentPath","getSubOptions","parentPath","events","createEmitter","set","readOnly","disabled","breadcrumbSettings","buttonSettings","clone","viewAsHtml","language","template","templates","renderMode","attachMode","iconset","fileService","onChange","render","label","subform","renderTemplate","asString","getValueAsString","_id","keys","attach","element","_this","then","isSubFormLazyLoad","hasLoadedForm","subFormLoading","empty","builder","setContent","ce","class","text","title","isNestedWizard","root","hasSetValue","dataValue","state","setDefaultValue","restoreValue","modalEdit","modalShouldBeOpened","componentModal","isOpened","currentValue","setOpenModalElement","detach","_currentForm","_this2","getComponents","forEach","currentForm","Array","isArray","isNumber","_vid","destroy","redraw","everyComponent","_this$subForm","updateSubWizards","_this$root","_subForm$_form","_this3","subWizards","_form","existedForm","findIndex","push","emit","fromAttach","_this4","loadSubForm","eachComponent","hideSubmitButton","ready","parent","parentVisible","visible","on","getValue","triggerChange","noEmit","url","nosubmit","localRoot","isSubmitButton","type","action","hidden","_this5","isHidden","isRevisionChanged","config","loadForm","params","live","checkComponentValidity","dirty","row","silentCheck","checkValidity","checkComponentConditions","flags","_this6","checkConditions","calculateValue","setPristine","pristine","reference","getSubFormData","getSubmission","submitSubForm","rejectOnError","_this7","shouldSubmit","submitForm","loading","showAllErrors","submission","catch","err","onSubmissionError","reject","beforePage","next","_this8","beforeSubmit","_this$subForm2","_this9","isAlreadySubmitted","wizard","_this$root2","_this$root2$_form","lazyLoad","rootValue","setValue","_this10","changed","_this$subForm$form","shouldLoadOriginalRevision","_fvid","setSubFormValue","shouldLoadSubmissionById","isEmpty","formId","submissionUrl","setUrl","loadSubmission","isEqual","emptyValue","areAllComponentsEmpty","res","comp","componentValue","errors","updateSubFormVisibility","_this$subForm3","_this$subForm3$_form","_this$parent","_this$parent$parent","_this$parent$parent$_","_this11","_visible","clearOnHide","rebuild","_this12","_parentVisible","isInternalEvent","event","emitter","nativeEmit","that","eventType","namespace","_len","args","_key","deleteValue","noUpdateEvent","noDefault","unset","_len2","extend","_key2","tableView","icon","group","documentation","weight"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.number.parse-int.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Component2 = _interopRequireDefault(require(\"../_classes/component/Component\"));\n\nvar _ComponentModal = _interopRequireDefault(require(\"../_classes/componentModal/ComponentModal\"));\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nvar _Formio = _interopRequireDefault(require(\"../../Formio\"));\n\nvar _Form = _interopRequireDefault(require(\"../../Form\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar FormComponent = /*#__PURE__*/function (_Component) {\n  _inherits(FormComponent, _Component);\n\n  var _super = _createSuper(FormComponent);\n\n  function FormComponent() {\n    _classCallCheck(this, FormComponent);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FormComponent, [{\n    key: \"init\",\n    value: function init() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"init\", this).call(this);\n\n      this.formObj = {\n        display: this.component.display,\n        settings: this.component.settings,\n        components: this.component.components\n      };\n      this.valueChanged = false;\n      this.subForm = null;\n      this.formSrc = '';\n\n      if (this.component.src) {\n        this.formSrc = this.component.src;\n      }\n\n      if (!this.component.src && !this.options.formio && (this.component.form || this.component.path)) {\n        if (this.component.project) {\n          this.formSrc = _Formio.default.getBaseUrl(); // Check to see if it is a MongoID.\n\n          if ((0, _utils.isMongoId)(this.component.project)) {\n            this.formSrc += '/project';\n          }\n\n          this.formSrc += \"/\".concat(this.component.project);\n          this.options.project = this.formSrc;\n        } else {\n          this.formSrc = _Formio.default.getProjectUrl();\n          this.options.project = this.formSrc;\n        }\n\n        if (this.component.form) {\n          this.formSrc += \"/form/\".concat(this.component.form);\n        } else if (this.component.path) {\n          this.formSrc += \"/\".concat(this.component.path);\n        }\n      } // Build the source based on the root src path.\n\n\n      if (!this.formSrc && this.options.formio) {\n        var rootSrc = this.options.formio.formsUrl;\n\n        if (this.component.path) {\n          var parts = rootSrc.split('/');\n          parts.pop();\n          this.formSrc = \"\".concat(parts.join('/'), \"/\").concat(this.component.path);\n        }\n\n        if (this.component.form) {\n          this.formSrc = \"\".concat(rootSrc, \"/\").concat(this.component.form);\n        }\n      }\n\n      if (this.builderMode && this.component.hasOwnProperty('formRevision')) {\n        this.component.revision = this.component.formRevision;\n        delete this.component.formRevision;\n      } // Add revision version if set.\n\n\n      if (this.component.revision || this.component.revision === 0 || this.component.formRevision || this.component.formRevision === 0) {\n        this.setFormRevision(this.component.revision || this.component.formRevision);\n      }\n\n      return this.createSubForm();\n    }\n  }, {\n    key: \"dataReady\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      // Not not provide a default value unless the subform is ready so that it will initialize correctly.\n      return this.subForm ? _get(_getPrototypeOf(FormComponent.prototype), \"defaultValue\", this) : null;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return FormComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return {\n        data: {}\n      };\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.subFormReady || _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"useOriginalRevision\",\n    get: function get() {\n      var _this$component, _this$formObj;\n\n      return ((_this$component = this.component) === null || _this$component === void 0 ? void 0 : _this$component.useOriginalRevision) && !!((_this$formObj = this.formObj) !== null && _this$formObj !== void 0 && _this$formObj.revisions);\n    }\n  }, {\n    key: \"setFormRevision\",\n    value: function setFormRevision(rev) {\n      // Remove current revisions from src if it is\n      this.formSrc = this.formSrc.replace(/\\/v\\/\\d*/, '');\n      var revNumber = Number.parseInt(rev);\n\n      if (!isNaN(revNumber)) {\n        this.subFormRevision = rev;\n        this.formSrc += \"/v/\".concat(rev);\n      } else {\n        this.subFormRevision = undefined;\n      }\n    }\n  }, {\n    key: \"getComponent\",\n    value: function getComponent(path, fn) {\n      path = (0, _utils.getArrayFromComponentPath)(path);\n\n      if (path[0] === 'data') {\n        path.shift();\n      }\n\n      var originalPathStr = \"\".concat(this.path, \".data.\").concat((0, _utils.getStringFromComponentPath)(path));\n\n      if (this.subForm) {\n        return this.subForm.getComponent(path, fn, originalPathStr);\n      }\n    }\n  }, {\n    key: \"getSubOptions\",\n    value: function getSubOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      options.parentPath = \"\".concat(this.path, \".data.\");\n      options.events = this.createEmitter(); // Make sure to not show the submit button in wizards in the nested forms.\n\n      _lodash.default.set(options, 'buttonSettings.showSubmit', false);\n\n      if (!this.options) {\n        return options;\n      }\n\n      if (this.options.base) {\n        options.base = this.options.base;\n      }\n\n      if (this.options.project) {\n        options.project = this.options.project;\n      }\n\n      if (this.options.readOnly || this.component.disabled) {\n        options.readOnly = this.options.readOnly || this.component.disabled;\n      }\n\n      if (this.options.breadcrumbSettings) {\n        options.breadcrumbSettings = this.options.breadcrumbSettings;\n      }\n\n      if (this.options.buttonSettings) {\n        options.buttonSettings = _lodash.default.clone(this.options.buttonSettings);\n      }\n\n      if (this.options.viewAsHtml) {\n        options.viewAsHtml = this.options.viewAsHtml;\n      }\n\n      if (this.options.language) {\n        options.language = this.options.language;\n      }\n\n      if (this.options.template) {\n        options.template = this.options.template;\n      }\n\n      if (this.options.templates) {\n        options.templates = this.options.templates;\n      }\n\n      if (this.options.renderMode) {\n        options.renderMode = this.options.renderMode;\n      }\n\n      if (this.options.attachMode) {\n        options.attachMode = this.options.attachMode;\n      }\n\n      if (this.options.iconset) {\n        options.iconset = this.options.iconset;\n      }\n\n      if (this.options.fileService) {\n        options.fileService = this.options.fileService;\n      }\n\n      if (this.options.onChange) {\n        options.onChange = this.options.onChange;\n      }\n\n      return options;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, this.component.label || 'Nested form');\n      }\n\n      var subform = this.subForm ? this.subForm.render() : this.renderTemplate('loading');\n      return _get(_getPrototypeOf(FormComponent.prototype), \"render\", this).call(this, subform);\n    }\n  }, {\n    key: \"asString\",\n    value: function asString(value) {\n      return this.getValueAsString(value);\n    }\n    /**\n     * Prints out the value of form components as a datagrid value.\n     */\n\n  }, {\n    key: \"getValueAsString\",\n    value: function getValueAsString(value) {\n      if (!value) {\n        return 'No data provided';\n      }\n\n      if (!value.data && value._id) {\n        return value._id;\n      }\n\n      if (!value.data || !Object.keys(value.data).length) {\n        return 'No data provided';\n      }\n\n      return '[Complex Data]';\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this = this;\n\n      // Don't attach in builder.\n      if (this.builderMode) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"attach\", this).call(this, element).then(function () {\n        if (_this.isSubFormLazyLoad() && !_this.hasLoadedForm && !_this.subFormLoading) {\n          _this.createSubForm(true);\n        }\n\n        return _this.subFormReady.then(function () {\n          _this.empty(element);\n\n          if (_this.options.builder) {\n            _this.setContent(element, _this.ce('div', {\n              class: 'text-muted text-center p-2'\n            }, _this.text(_this.formObj.title)));\n\n            return;\n          }\n\n          _this.setContent(element, _this.render());\n\n          if (_this.subForm) {\n            if (_this.isNestedWizard) {\n              element = _this.root.element;\n            }\n\n            _this.subForm.attach(element);\n\n            _this.valueChanged = _this.hasSetValue;\n\n            if (!_this.valueChanged && _this.dataValue.state !== 'submitted') {\n              _this.setDefaultValue();\n            } else {\n              _this.restoreValue();\n            }\n          }\n\n          if (!_this.builderMode && _this.component.modalEdit) {\n            var modalShouldBeOpened = _this.componentModal ? _this.componentModal.isOpened : false;\n            var currentValue = modalShouldBeOpened ? _this.componentModal.currentValue : _this.dataValue;\n            _this.componentModal = new _ComponentModal.default(_this, element, modalShouldBeOpened, currentValue);\n\n            _this.setOpenModalElement();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.subForm) {\n        this.subForm.detach();\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"currentForm\",\n    get: function get() {\n      return this._currentForm;\n    },\n    set: function set(instance) {\n      var _this2 = this;\n\n      this._currentForm = instance;\n\n      if (!this.subForm) {\n        return;\n      }\n\n      this.subForm.getComponents().forEach(function (component) {\n        component.currentForm = _this2;\n      });\n    }\n  }, {\n    key: \"hasLoadedForm\",\n    get: function get() {\n      return this.formObj && this.formObj.components && Array.isArray(this.formObj.components) && this.formObj.components.length;\n    }\n  }, {\n    key: \"isRevisionChanged\",\n    get: function get() {\n      return _lodash.default.isNumber(this.subFormRevision) && _lodash.default.isNumber(this.formObj._vid) && this.formObj._vid !== this.subFormRevision;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.subForm) {\n        this.subForm.destroy();\n        this.subForm = null;\n        this.subFormReady = null;\n      }\n\n      _get(_getPrototypeOf(FormComponent.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      if (this.subForm) {\n        this.subForm.form = this.formObj;\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"redraw\", this).call(this);\n    }\n    /**\n     * Pass everyComponent to subform.\n     * @param args\n     * @returns {*|void}\n     */\n\n  }, {\n    key: \"everyComponent\",\n    value: function everyComponent() {\n      if (this.subForm) {\n        var _this$subForm;\n\n        (_this$subForm = this.subForm).everyComponent.apply(_this$subForm, arguments);\n      }\n    }\n  }, {\n    key: \"updateSubWizards\",\n    value: function updateSubWizards(subForm) {\n      var _this$root,\n          _subForm$_form,\n          _this3 = this;\n\n      if (this.isNestedWizard && (_this$root = this.root) !== null && _this$root !== void 0 && _this$root.subWizards && (subForm === null || subForm === void 0 ? void 0 : (_subForm$_form = subForm._form) === null || _subForm$_form === void 0 ? void 0 : _subForm$_form.display) === 'wizard') {\n        var existedForm = this.root.subWizards.findIndex(function (form) {\n          return form.component.form === _this3.component.form;\n        });\n\n        if (existedForm !== -1) {\n          this.root.subWizards[existedForm] = this;\n        } else {\n          this.root.subWizards.push(this);\n        }\n\n        this.emit('subWizardsUpdated', subForm);\n      }\n    }\n    /**\n     * Create a subform instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"createSubForm\",\n    value: function createSubForm(fromAttach) {\n      var _this4 = this;\n\n      this.subFormReady = this.loadSubForm(fromAttach).then(function (form) {\n        if (!form) {\n          return;\n        } // Iterate through every component and hide the submit button.\n\n\n        (0, _utils.eachComponent)(form.components, function (component) {\n          _this4.hideSubmitButton(component);\n        }); // If the subform is already created then destroy the old one.\n\n        if (_this4.subForm) {\n          _this4.subForm.destroy();\n        } // Render the form.\n\n\n        return new _Form.default(form, _this4.getSubOptions()).ready.then(function (instance) {\n          _this4.subForm = instance;\n          _this4.subForm.currentForm = _this4;\n          _this4.subForm.parent = _this4;\n          _this4.subForm.parentVisible = _this4.visible;\n\n          _this4.subForm.on('change', function () {\n            if (_this4.subForm) {\n              _this4.dataValue = _this4.subForm.getValue();\n\n              _this4.triggerChange({\n                noEmit: true\n              });\n            }\n          });\n\n          _this4.subForm.url = _this4.formSrc;\n          _this4.subForm.nosubmit = true;\n          _this4.subForm.root = _this4.root;\n          _this4.subForm.localRoot = _this4.isNestedWizard ? _this4.localRoot : _this4.subForm;\n\n          _this4.restoreValue();\n\n          _this4.valueChanged = _this4.hasSetValue;\n          return _this4.subForm;\n        });\n      }).then(function (subForm) {\n        _this4.updateSubWizards(subForm);\n\n        return subForm;\n      });\n      return this.subFormReady;\n    }\n  }, {\n    key: \"hideSubmitButton\",\n    value: function hideSubmitButton(component) {\n      var isSubmitButton = component.type === 'button' && (component.action === 'submit' || !component.action);\n\n      if (isSubmitButton) {\n        component.hidden = true;\n      }\n    }\n    /**\n     * Load the subform.\n     */\n\n  }, {\n    key: \"loadSubForm\",\n    value: function loadSubForm(fromAttach) {\n      var _this5 = this;\n\n      if (this.builderMode || this.isHidden() || this.isSubFormLazyLoad() && !fromAttach) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (this.hasLoadedForm && !this.isRevisionChanged) {\n        // Pass config down to sub forms.\n        if (this.root && this.root.form && this.root.form.config && !this.formObj.config) {\n          this.formObj.config = this.root.form.config;\n        }\n\n        return _nativePromiseOnly.default.resolve(this.formObj);\n      } else if (this.formSrc) {\n        this.subFormLoading = true;\n        return new _Formio.default(this.formSrc).loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (formObj) {\n          _this5.formObj = formObj;\n          _this5.subFormLoading = false;\n          return formObj;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"checkComponentValidity\",\n    value: function checkComponentValidity(data, dirty, row, options) {\n      options = options || {};\n      var silentCheck = options.silentCheck || false;\n\n      if (this.subForm) {\n        return this.subForm.checkValidity(this.dataValue.data, dirty, null, silentCheck);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentValidity\", this).call(this, data, dirty, row, options);\n    }\n  }, {\n    key: \"checkComponentConditions\",\n    value: function checkComponentConditions(data, flags, row) {\n      var _this6 = this;\n\n      var visible = _get(_getPrototypeOf(FormComponent.prototype), \"checkComponentConditions\", this).call(this, data, flags, row); // Return if already hidden\n\n\n      if (!visible) {\n        return visible;\n      }\n\n      if (this.subForm) {\n        return this.subForm.checkConditions(this.dataValue.data);\n      } // There are few cases when subForm is not loaded when a change is triggered,\n      // so we need to perform checkConditions after it is ready, or some conditional fields might be hidden in View mode\n      else if (this.subFormReady) {\n          this.subFormReady.then(function () {\n            if (_this6.subForm) {\n              return _this6.subForm.checkConditions(_this6.dataValue.data);\n            }\n          });\n        }\n\n      return visible;\n    }\n  }, {\n    key: \"calculateValue\",\n    value: function calculateValue(data, flags, row) {\n      if (this.subForm) {\n        return this.subForm.calculateValue(this.dataValue.data, flags);\n      }\n\n      return _get(_getPrototypeOf(FormComponent.prototype), \"calculateValue\", this).call(this, data, flags, row);\n    }\n  }, {\n    key: \"setPristine\",\n    value: function setPristine(pristine) {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setPristine\", this).call(this, pristine);\n\n      if (this.subForm) {\n        this.subForm.setPristine(pristine);\n      }\n    }\n    /**\n     * Determine if the subform should be submitted.\n     * @return {*|boolean}\n     */\n\n  }, {\n    key: \"shouldSubmit\",\n    get: function get() {\n      return this.subFormReady && (!this.component.hasOwnProperty('reference') || this.component.reference) && !this.isHidden();\n    }\n    /**\n     * Returns the data for the subform.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getSubFormData\",\n    value: function getSubFormData() {\n      if (_lodash.default.get(this.subForm, 'form.display') === 'pdf') {\n        return this.subForm.getSubmission();\n      } else {\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n    }\n    /**\n     * Submit the subform if configured to do so.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"submitSubForm\",\n    value: function submitSubForm(rejectOnError) {\n      var _this7 = this;\n\n      // If we wish to submit the form on next page, then do that here.\n      if (this.shouldSubmit) {\n        return this.subFormReady.then(function () {\n          if (!_this7.subForm) {\n            return _this7.dataValue;\n          }\n\n          _this7.subForm.nosubmit = false;\n          return _this7.subForm.submitForm().then(function (result) {\n            _this7.subForm.loading = false;\n            _this7.subForm.showAllErrors = false;\n            _this7.dataValue = result.submission;\n            return _this7.dataValue;\n          }).catch(function (err) {\n            _this7.subForm.showAllErrors = true;\n\n            if (rejectOnError) {\n              _this7.subForm.onSubmissionError(err);\n\n              return _nativePromiseOnly.default.reject(err);\n            } else {\n              return {};\n            }\n          });\n        });\n      }\n\n      return this.getSubFormData();\n    }\n    /**\n     * Submit the form before the next page is triggered.\n     */\n\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this8 = this;\n\n      // Should not submit child forms if we are going to the previous page\n      if (!next) {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", this).call(this, next);\n      }\n\n      return this.submitSubForm(true).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforePage\", _this8).call(_this8, next);\n      });\n    }\n    /**\n     * Submit the form before the whole form is triggered.\n     */\n\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var _this$subForm2,\n          _this9 = this;\n\n      var submission = this.dataValue;\n      var isAlreadySubmitted = submission && submission._id && submission.form; // This submission has already been submitted, so just return the reference data.\n\n      if (isAlreadySubmitted && !((_this$subForm2 = this.subForm) !== null && _this$subForm2 !== void 0 && _this$subForm2.wizard)) {\n        this.dataValue = submission;\n        return _nativePromiseOnly.default.resolve(this.dataValue);\n      }\n\n      return this.submitSubForm(false).then(function () {\n        return _this9.dataValue;\n      }).then(function () {\n        return _get(_getPrototypeOf(FormComponent.prototype), \"beforeSubmit\", _this9).call(_this9);\n      });\n    }\n  }, {\n    key: \"isSubFormLazyLoad\",\n    value: function isSubFormLazyLoad() {\n      var _this$root2, _this$root2$_form;\n\n      return ((_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : (_this$root2$_form = _this$root2._form) === null || _this$root2$_form === void 0 ? void 0 : _this$root2$_form.display) === 'wizard' && this.component.lazyLoad;\n    }\n  }, {\n    key: \"isHidden\",\n    value: function isHidden() {\n      if (!this.visible) {\n        return true;\n      }\n\n      return !_get(_getPrototypeOf(FormComponent.prototype), \"checkConditions\", this).call(this, this.rootValue);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this10 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var changed = _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, submission, flags);\n\n      this.valueChanged = true;\n\n      if (this.subForm) {\n        var _this$subForm$form;\n\n        var shouldLoadOriginalRevision = this.useOriginalRevision && _lodash.default.isNumber(submission._fvid) && _lodash.default.isNumber((_this$subForm$form = this.subForm.form) === null || _this$subForm$form === void 0 ? void 0 : _this$subForm$form._vid) && submission._fvid !== this.subForm.form._vid;\n\n        if (shouldLoadOriginalRevision) {\n          this.setFormRevision(submission._fvid);\n          this.createSubForm().then(function () {\n            _this10.attach(_this10.element);\n          });\n        } else {\n          this.setSubFormValue(submission, flags);\n        }\n      }\n\n      return changed;\n    }\n  }, {\n    key: \"setSubFormValue\",\n    value: function setSubFormValue(submission, flags) {\n      var shouldLoadSubmissionById = submission && submission._id && this.subForm.formio && _lodash.default.isEmpty(submission.data);\n\n      if (shouldLoadSubmissionById) {\n        var formId = submission.form || this.formObj.form || this.component.form;\n        var submissionUrl = \"\".concat(this.subForm.formio.formsUrl, \"/\").concat(formId, \"/submission/\").concat(submission._id);\n        this.subForm.setUrl(submissionUrl, this.options);\n        this.subForm.loadSubmission();\n      } else {\n        this.subForm.setValue(submission, flags);\n      }\n    }\n  }, {\n    key: \"isEmpty\",\n    value: function isEmpty() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.dataValue;\n      return value === null || _lodash.default.isEqual(value, this.emptyValue) || this.areAllComponentsEmpty(value.data) && !value._id;\n    }\n  }, {\n    key: \"areAllComponentsEmpty\",\n    value: function areAllComponentsEmpty(data) {\n      var res = true;\n\n      if (this.subForm) {\n        this.subForm.everyComponent(function (comp) {\n          var componentValue = _lodash.default.get(data, comp.key);\n\n          res &= comp.isEmpty(componentValue);\n        });\n      } else {\n        res = false;\n      }\n\n      return res;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (this.subForm) {\n        return this.subForm.getValue();\n      }\n\n      return this.dataValue;\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      var errors = _get(_getPrototypeOf(FormComponent.prototype), \"errors\", this);\n\n      if (this.subForm) {\n        errors = errors.concat(this.subForm.errors);\n      }\n\n      return errors;\n    }\n  }, {\n    key: \"updateSubFormVisibility\",\n    value: function updateSubFormVisibility() {\n      if (this.subForm) {\n        this.subForm.parentVisible = this.visible;\n      }\n    }\n    /**\n     * Determines if this form is a Nested Wizard\n     * which means it should be a Wizard itself and should be a direct child of a Wizard's page\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isNestedWizard\",\n    get: function get() {\n      var _this$subForm3, _this$subForm3$_form, _this$parent, _this$parent$parent, _this$parent$parent$_;\n\n      return ((_this$subForm3 = this.subForm) === null || _this$subForm3 === void 0 ? void 0 : (_this$subForm3$_form = _this$subForm3._form) === null || _this$subForm3$_form === void 0 ? void 0 : _this$subForm3$_form.display) === 'wizard' && ((_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : (_this$parent$parent = _this$parent.parent) === null || _this$parent$parent === void 0 ? void 0 : (_this$parent$parent$_ = _this$parent$parent._form) === null || _this$parent$parent$_ === void 0 ? void 0 : _this$parent$parent$_.display) === 'wizard';\n    }\n  }, {\n    key: \"visible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"visible\", this);\n    },\n    set: function set(value) {\n      var _this11 = this;\n\n      var isNestedWizard = this.isNestedWizard;\n\n      if (this._visible !== value) {\n        this._visible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this11.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        isNestedWizard ? this.rebuild() : this.redraw();\n      }\n\n      if (!value && isNestedWizard) {\n        this.root.redraw();\n      }\n    }\n  }, {\n    key: \"parentVisible\",\n    get: function get() {\n      return _get(_getPrototypeOf(FormComponent.prototype), \"parentVisible\", this);\n    },\n    set: function set(value) {\n      var _this12 = this;\n\n      if (this._parentVisible !== value) {\n        this._parentVisible = value;\n        this.clearOnHide(); // Form doesn't load if hidden. If it becomes visible, create the form.\n\n        if (!this.subForm && value) {\n          this.createSubForm();\n          this.subFormReady.then(function () {\n            _this12.updateSubFormVisibility();\n          });\n          this.redraw();\n          return;\n        }\n\n        this.updateSubFormVisibility();\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"isInternalEvent\",\n    value: function isInternalEvent(event) {\n      switch (event) {\n        case 'focus':\n        case 'blur':\n        case 'componentChange':\n        case 'componentError':\n        case 'error':\n        case 'formLoad':\n        case 'languageChanged':\n        case 'render':\n        case 'checkValidity':\n        case 'initialized':\n        case 'submit':\n        case 'submitButton':\n        case 'nosubmit':\n        case 'updateComponent':\n        case 'submitDone':\n        case 'submissionDeleted':\n        case 'requestDone':\n        case 'nextPage':\n        case 'prevPage':\n        case 'wizardNavigationClicked':\n        case 'updateWizardNav':\n        case 'restoreDraft':\n        case 'saveDraft':\n        case 'saveComponent':\n        case 'pdfUploaded':\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"createEmitter\",\n    value: function createEmitter() {\n      var emitter = new _eventemitter.default();\n      var nativeEmit = emitter.emit;\n      var that = this;\n\n      emitter.emit = function (event) {\n        var eventType = event.replace(\"\".concat(that.options.namespace, \".\"), '');\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        nativeEmit.call.apply(nativeEmit, [this, event].concat(args));\n\n        if (!that.isInternalEvent(eventType)) {\n          that.emit.apply(that, [eventType].concat(args));\n        }\n      };\n\n      return emitter;\n    }\n  }, {\n    key: \"deleteValue\",\n    value: function deleteValue() {\n      _get(_getPrototypeOf(FormComponent.prototype), \"setValue\", this).call(this, null, {\n        noUpdateEvent: true,\n        noDefault: true\n      });\n\n      this.unset();\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len2 = arguments.length, extend = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        extend[_key2] = arguments[_key2];\n      }\n\n      return _Component2.default.schema.apply(_Component2.default, [{\n        label: 'Form',\n        type: 'form',\n        key: 'form',\n        src: '',\n        reference: true,\n        form: '',\n        path: '',\n        tableView: true\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Nested Form',\n        icon: 'wpforms',\n        group: 'premium',\n        documentation: '/userguide/#form',\n        weight: 110,\n        schema: FormComponent.schema()\n      };\n    }\n  }]);\n\n  return FormComponent;\n}(_Component2.default);\n\nexports.default = FormComponent;"]},"metadata":{},"sourceType":"script"}