{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction set(target, property, value, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.set) {\n    set = Reflect.set;\n  } else {\n    set = function set(target, property, value, receiver) {\n      var base = _superPropBase(target, property);\n\n      var desc;\n\n      if (base) {\n        desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.set) {\n          desc.set.call(receiver, value);\n          return true;\n        } else if (!desc.writable) {\n          return false;\n        }\n      }\n\n      desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n      if (desc) {\n        if (!desc.writable) {\n          return false;\n        }\n\n        desc.value = value;\n        Object.defineProperty(receiver, property, desc);\n      } else {\n        _defineProperty(receiver, property, value);\n      }\n\n      return true;\n    };\n  }\n\n  return set(target, property, value, receiver);\n}\n\nfunction _set(target, property, value, receiver, isStrict) {\n  var s = set(target, property, value, receiver || target);\n\n  if (!s && isStrict) {\n    throw new Error('failed to set property');\n  }\n\n  return value;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar Multivalue = /*#__PURE__*/function (_Field) {\n  _inherits(Multivalue, _Field);\n\n  var _super = _createSuper(Multivalue);\n\n  function Multivalue() {\n    _classCallCheck(this, Multivalue);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Multivalue, [{\n    key: \"dataValue\",\n    get: function get() {\n      var parent = _get(_getPrototypeOf(Multivalue.prototype), \"dataValue\", this);\n\n      if (!parent && this.component.multiple) {\n        return [];\n      }\n\n      return parent;\n    },\n    set: function set(value) {\n      _set(_getPrototypeOf(Multivalue.prototype), \"dataValue\", value, this, true);\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(Multivalue.prototype), \"defaultValue\", this);\n\n      if (this.component.multiple) {\n        if (_lodash.default.isArray(value)) {\n          value = !value.length ? [_get(_getPrototypeOf(Multivalue.prototype), \"emptyValue\", this)] : value;\n        } else {\n          value = [value];\n        }\n      }\n\n      return value;\n    }\n  }, {\n    key: \"addAnother\",\n    get: function get() {\n      return this.t(this.component.addAnother || 'Add Another');\n    }\n  }, {\n    key: \"useWrapper\",\n    value: function useWrapper() {\n      return this.component.hasOwnProperty('multiple') && this.component.multiple;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // If single value field.\n      if (!this.useWrapper()) {\n        return _get(_getPrototypeOf(Multivalue.prototype), \"render\", this).call(this, \"<div ref=\\\"element\\\">\\n          \".concat(this.renderElement(this.component.type !== 'hidden' ? this.dataValue : ''), \"\\n        </div>\"));\n      } // Make sure dataValue is in the correct array format.\n\n\n      var dataValue = this.dataValue;\n\n      if (!Array.isArray(dataValue)) {\n        dataValue = dataValue ? [dataValue] : [];\n      } // If multiple value field.\n\n\n      return _get(_getPrototypeOf(Multivalue.prototype), \"render\", this).call(this, this.renderTemplate('multiValueTable', {\n        rows: dataValue.map(this.renderRow.bind(this)).join(''),\n        disabled: this.disabled,\n        addAnother: this.addAnother\n      }));\n    }\n  }, {\n    key: \"renderElement\",\n    value: function renderElement() {\n      return '';\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(value, index) {\n      return this.renderTemplate('multiValueRow', {\n        index: index,\n        disabled: this.disabled,\n        element: \"\".concat(this.renderElement(value, index))\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(dom) {\n      var _this = this;\n\n      var superAttach = _get(_getPrototypeOf(Multivalue.prototype), \"attach\", this).call(this, dom);\n\n      this.loadRefs(dom, {\n        addButton: 'multiple',\n        input: 'multiple',\n        removeRow: 'multiple',\n        mask: 'multiple',\n        select: 'multiple'\n      });\n      var promises = [];\n      this.refs.input.forEach(function (element, index) {\n        promises.push(_this.attachElement.call(_this, element, index));\n      });\n\n      if (!this.component.multiple) {\n        return _nativePromiseOnly.default.all(promises);\n      }\n\n      this.refs.removeRow.forEach(function (removeButton, index) {\n        _this.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this.removeValue(index);\n        });\n      }); // If single value field.\n\n      this.refs.addButton.forEach(function (addButton) {\n        _this.addEventListener(addButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this.addValue();\n        });\n      });\n      return superAttach.then(function () {\n        return _nativePromiseOnly.default.all(promises);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.refs.input && this.refs.input.length) {\n        this.refs.input.forEach(function (input) {\n          if (input.mask) {\n            input.mask.destroy();\n          }\n\n          if (input.widget) {\n            input.widget.destroy();\n          }\n        });\n      }\n\n      if (this.refs.mask && this.refs.mask.length) {\n        this.refs.mask.forEach(function (input) {\n          if (input.mask) {\n            input.mask.destroy();\n          }\n        });\n      }\n\n      _get(_getPrototypeOf(Multivalue.prototype), \"detach\", this).call(this);\n    }\n    /**\n     * Attach inputs to the element.\n     *\n     * @param element\n     * @param index\n     */\n\n  }, {\n    key: \"attachElement\",\n    value: function attachElement(element, index) {\n      var _this2 = this;\n\n      this.addEventListener(element, this.inputInfo.changeEvent, function () {\n        // Delay update slightly to give input mask a chance to run.\n        var textCase = _lodash.default.get(_this2.component, 'case', 'mixed');\n\n        if (textCase !== 'mixed') {\n          var selectionStart = element.selectionStart,\n              selectionEnd = element.selectionEnd;\n\n          if (textCase === 'uppercase' && element.value) {\n            element.value = element.value.toUpperCase();\n          }\n\n          if (textCase === 'lowercase' && element.value) {\n            element.value = element.value.toLowerCase();\n          }\n\n          if (element.selectionStart && element.selectionEnd) {\n            element.selectionStart = selectionStart;\n            element.selectionEnd = selectionEnd;\n          }\n        }\n\n        _this2.saveCaretPosition(element, index); // If a mask is present, delay the update to allow mask to update first.\n\n\n        if (element.mask) {\n          setTimeout(function () {\n            return _this2.updateValue(null, {\n              modified: _this2.component.type !== 'hidden'\n            }, index);\n          }, 1);\n        } else {\n          return _this2.updateValue(null, {\n            modified: _this2.component.type !== 'hidden'\n          }, index);\n        }\n      });\n\n      if (!this.attachMultiMask(index)) {\n        this.setInputMask(element);\n      }\n    } // Saves current caret position to restore it after the component is redrawn\n\n  }, {\n    key: \"saveCaretPosition\",\n    value: function saveCaretPosition(element, index) {\n      var _this$root, _this$root$focusedCom;\n\n      if (((_this$root = this.root) === null || _this$root === void 0 ? void 0 : (_this$root$focusedCom = _this$root.focusedComponent) === null || _this$root$focusedCom === void 0 ? void 0 : _this$root$focusedCom.path) === this.path) {\n        this.root.currentSelection = {\n          selection: [element.selectionStart, element.selectionEnd],\n          index: index\n        };\n      }\n    }\n  }, {\n    key: \"onSelectMaskHandler\",\n    value: function onSelectMaskHandler(event) {\n      this.updateMask(event.target.maskInput, this.getMaskPattern(event.target.value));\n    }\n  }, {\n    key: \"getMaskPattern\",\n    value: function getMaskPattern(maskName) {\n      if (!this.multiMasks) {\n        this.multiMasks = {};\n      }\n\n      if (this.multiMasks[maskName]) {\n        return this.multiMasks[maskName];\n      }\n\n      var mask = this.component.inputMasks.find(function (inputMask) {\n        return inputMask.label === maskName;\n      });\n      this.multiMasks[maskName] = mask ? mask.mask : this.component.inputMasks[0].mask;\n      return this.multiMasks[maskName];\n    }\n  }, {\n    key: \"attachMultiMask\",\n    value: function attachMultiMask(index) {\n      if (!(this.isMultipleMasksField && this.component.inputMasks.length && this.refs.input.length)) {\n        return false;\n      }\n\n      var maskSelect = this.refs.select[index];\n      maskSelect.onchange = this.onSelectMaskHandler.bind(this);\n      maskSelect.maskInput = this.refs.mask[index];\n      this.setInputMask(maskSelect.maskInput, this.component.inputMasks[0].mask);\n      return true;\n    }\n  }, {\n    key: \"updateMask\",\n    value: function updateMask(input, mask) {\n      if (!mask) {\n        return;\n      }\n\n      this.setInputMask(input, mask, !this.component.placeholder);\n      this.updateValue();\n    }\n    /**\n     * Adds a new empty value to the data array.\n     */\n\n  }, {\n    key: \"addNewValue\",\n    value: function addNewValue(value) {\n      if (value === undefined) {\n        value = this.component.defaultValue ? this.component.defaultValue : this.emptyValue; // If default is an empty aray, default back to empty value.\n\n        if (Array.isArray(value) && value.length === 0) {\n          value = this.emptyValue;\n        }\n      }\n\n      var dataValue = this.dataValue || [];\n\n      if (!Array.isArray(dataValue)) {\n        dataValue = [dataValue];\n      }\n\n      if (Array.isArray(value)) {\n        dataValue = dataValue.concat(value);\n      } else {\n        dataValue.push(value);\n      }\n\n      this.dataValue = dataValue;\n    }\n    /**\n     * Adds a new empty value to the data array, and add a new row to contain it.\n     */\n\n  }, {\n    key: \"addValue\",\n    value: function addValue() {\n      this.addNewValue();\n      this.redraw();\n      this.checkConditions();\n\n      if (!this.isEmpty(this.dataValue)) {\n        this.restoreValue();\n      }\n\n      if (this.root) {\n        this.root.onChange();\n      }\n    }\n  }]);\n\n  return Multivalue;\n}(_Field2.default);\n\nexports.default = Multivalue;","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/formiojs/components/_classes/multivalue/Multivalue.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_Field2","_interopRequireDefault","require","_nativePromiseOnly","_lodash","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","set","property","receiver","Reflect","base","_superPropBase","desc","getOwnPropertyDescriptor","call","_defineProperty","_set","isStrict","s","Error","_get","get","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Multivalue","_Field","_super","parent","component","multiple","isArray","t","addAnother","useWrapper","render","concat","renderElement","type","dataValue","Array","renderTemplate","rows","map","renderRow","bind","join","disabled","index","element","attach","dom","_this","superAttach","loadRefs","addButton","input","removeRow","mask","select","promises","refs","forEach","push","attachElement","all","removeButton","addEventListener","event","preventDefault","removeValue","addValue","then","detach","destroy","widget","_this2","inputInfo","changeEvent","textCase","selectionStart","selectionEnd","toUpperCase","toLowerCase","saveCaretPosition","setTimeout","updateValue","modified","attachMultiMask","setInputMask","_this$root","_this$root$focusedCom","root","focusedComponent","path","currentSelection","selection","onSelectMaskHandler","updateMask","maskInput","getMaskPattern","maskName","multiMasks","inputMasks","find","inputMask","label","isMultipleMasksField","maskSelect","onchange","placeholder","addNewValue","undefined","defaultValue","emptyValue","redraw","checkConditions","isEmpty","restoreValue","onChange"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.reflect.set.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _Field2 = _interopRequireDefault(require(\"../field/Field\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction set(target, property, value, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }\n\nfunction _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Multivalue = /*#__PURE__*/function (_Field) {\n  _inherits(Multivalue, _Field);\n\n  var _super = _createSuper(Multivalue);\n\n  function Multivalue() {\n    _classCallCheck(this, Multivalue);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Multivalue, [{\n    key: \"dataValue\",\n    get: function get() {\n      var parent = _get(_getPrototypeOf(Multivalue.prototype), \"dataValue\", this);\n\n      if (!parent && this.component.multiple) {\n        return [];\n      }\n\n      return parent;\n    },\n    set: function set(value) {\n      _set(_getPrototypeOf(Multivalue.prototype), \"dataValue\", value, this, true);\n    }\n  }, {\n    key: \"defaultValue\",\n    get: function get() {\n      var value = _get(_getPrototypeOf(Multivalue.prototype), \"defaultValue\", this);\n\n      if (this.component.multiple) {\n        if (_lodash.default.isArray(value)) {\n          value = !value.length ? [_get(_getPrototypeOf(Multivalue.prototype), \"emptyValue\", this)] : value;\n        } else {\n          value = [value];\n        }\n      }\n\n      return value;\n    }\n  }, {\n    key: \"addAnother\",\n    get: function get() {\n      return this.t(this.component.addAnother || 'Add Another');\n    }\n  }, {\n    key: \"useWrapper\",\n    value: function useWrapper() {\n      return this.component.hasOwnProperty('multiple') && this.component.multiple;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // If single value field.\n      if (!this.useWrapper()) {\n        return _get(_getPrototypeOf(Multivalue.prototype), \"render\", this).call(this, \"<div ref=\\\"element\\\">\\n          \".concat(this.renderElement(this.component.type !== 'hidden' ? this.dataValue : ''), \"\\n        </div>\"));\n      } // Make sure dataValue is in the correct array format.\n\n\n      var dataValue = this.dataValue;\n\n      if (!Array.isArray(dataValue)) {\n        dataValue = dataValue ? [dataValue] : [];\n      } // If multiple value field.\n\n\n      return _get(_getPrototypeOf(Multivalue.prototype), \"render\", this).call(this, this.renderTemplate('multiValueTable', {\n        rows: dataValue.map(this.renderRow.bind(this)).join(''),\n        disabled: this.disabled,\n        addAnother: this.addAnother\n      }));\n    }\n  }, {\n    key: \"renderElement\",\n    value: function renderElement() {\n      return '';\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(value, index) {\n      return this.renderTemplate('multiValueRow', {\n        index: index,\n        disabled: this.disabled,\n        element: \"\".concat(this.renderElement(value, index))\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(dom) {\n      var _this = this;\n\n      var superAttach = _get(_getPrototypeOf(Multivalue.prototype), \"attach\", this).call(this, dom);\n\n      this.loadRefs(dom, {\n        addButton: 'multiple',\n        input: 'multiple',\n        removeRow: 'multiple',\n        mask: 'multiple',\n        select: 'multiple'\n      });\n      var promises = [];\n      this.refs.input.forEach(function (element, index) {\n        promises.push(_this.attachElement.call(_this, element, index));\n      });\n\n      if (!this.component.multiple) {\n        return _nativePromiseOnly.default.all(promises);\n      }\n\n      this.refs.removeRow.forEach(function (removeButton, index) {\n        _this.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this.removeValue(index);\n        });\n      }); // If single value field.\n\n      this.refs.addButton.forEach(function (addButton) {\n        _this.addEventListener(addButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this.addValue();\n        });\n      });\n      return superAttach.then(function () {\n        return _nativePromiseOnly.default.all(promises);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.refs.input && this.refs.input.length) {\n        this.refs.input.forEach(function (input) {\n          if (input.mask) {\n            input.mask.destroy();\n          }\n\n          if (input.widget) {\n            input.widget.destroy();\n          }\n        });\n      }\n\n      if (this.refs.mask && this.refs.mask.length) {\n        this.refs.mask.forEach(function (input) {\n          if (input.mask) {\n            input.mask.destroy();\n          }\n        });\n      }\n\n      _get(_getPrototypeOf(Multivalue.prototype), \"detach\", this).call(this);\n    }\n    /**\n     * Attach inputs to the element.\n     *\n     * @param element\n     * @param index\n     */\n\n  }, {\n    key: \"attachElement\",\n    value: function attachElement(element, index) {\n      var _this2 = this;\n\n      this.addEventListener(element, this.inputInfo.changeEvent, function () {\n        // Delay update slightly to give input mask a chance to run.\n        var textCase = _lodash.default.get(_this2.component, 'case', 'mixed');\n\n        if (textCase !== 'mixed') {\n          var selectionStart = element.selectionStart,\n              selectionEnd = element.selectionEnd;\n\n          if (textCase === 'uppercase' && element.value) {\n            element.value = element.value.toUpperCase();\n          }\n\n          if (textCase === 'lowercase' && element.value) {\n            element.value = element.value.toLowerCase();\n          }\n\n          if (element.selectionStart && element.selectionEnd) {\n            element.selectionStart = selectionStart;\n            element.selectionEnd = selectionEnd;\n          }\n        }\n\n        _this2.saveCaretPosition(element, index); // If a mask is present, delay the update to allow mask to update first.\n\n\n        if (element.mask) {\n          setTimeout(function () {\n            return _this2.updateValue(null, {\n              modified: _this2.component.type !== 'hidden'\n            }, index);\n          }, 1);\n        } else {\n          return _this2.updateValue(null, {\n            modified: _this2.component.type !== 'hidden'\n          }, index);\n        }\n      });\n\n      if (!this.attachMultiMask(index)) {\n        this.setInputMask(element);\n      }\n    } // Saves current caret position to restore it after the component is redrawn\n\n  }, {\n    key: \"saveCaretPosition\",\n    value: function saveCaretPosition(element, index) {\n      var _this$root, _this$root$focusedCom;\n\n      if (((_this$root = this.root) === null || _this$root === void 0 ? void 0 : (_this$root$focusedCom = _this$root.focusedComponent) === null || _this$root$focusedCom === void 0 ? void 0 : _this$root$focusedCom.path) === this.path) {\n        this.root.currentSelection = {\n          selection: [element.selectionStart, element.selectionEnd],\n          index: index\n        };\n      }\n    }\n  }, {\n    key: \"onSelectMaskHandler\",\n    value: function onSelectMaskHandler(event) {\n      this.updateMask(event.target.maskInput, this.getMaskPattern(event.target.value));\n    }\n  }, {\n    key: \"getMaskPattern\",\n    value: function getMaskPattern(maskName) {\n      if (!this.multiMasks) {\n        this.multiMasks = {};\n      }\n\n      if (this.multiMasks[maskName]) {\n        return this.multiMasks[maskName];\n      }\n\n      var mask = this.component.inputMasks.find(function (inputMask) {\n        return inputMask.label === maskName;\n      });\n      this.multiMasks[maskName] = mask ? mask.mask : this.component.inputMasks[0].mask;\n      return this.multiMasks[maskName];\n    }\n  }, {\n    key: \"attachMultiMask\",\n    value: function attachMultiMask(index) {\n      if (!(this.isMultipleMasksField && this.component.inputMasks.length && this.refs.input.length)) {\n        return false;\n      }\n\n      var maskSelect = this.refs.select[index];\n      maskSelect.onchange = this.onSelectMaskHandler.bind(this);\n      maskSelect.maskInput = this.refs.mask[index];\n      this.setInputMask(maskSelect.maskInput, this.component.inputMasks[0].mask);\n      return true;\n    }\n  }, {\n    key: \"updateMask\",\n    value: function updateMask(input, mask) {\n      if (!mask) {\n        return;\n      }\n\n      this.setInputMask(input, mask, !this.component.placeholder);\n      this.updateValue();\n    }\n    /**\n     * Adds a new empty value to the data array.\n     */\n\n  }, {\n    key: \"addNewValue\",\n    value: function addNewValue(value) {\n      if (value === undefined) {\n        value = this.component.defaultValue ? this.component.defaultValue : this.emptyValue; // If default is an empty aray, default back to empty value.\n\n        if (Array.isArray(value) && value.length === 0) {\n          value = this.emptyValue;\n        }\n      }\n\n      var dataValue = this.dataValue || [];\n\n      if (!Array.isArray(dataValue)) {\n        dataValue = [dataValue];\n      }\n\n      if (Array.isArray(value)) {\n        dataValue = dataValue.concat(value);\n      } else {\n        dataValue.push(value);\n      }\n\n      this.dataValue = dataValue;\n    }\n    /**\n     * Adds a new empty value to the data array, and add a new row to contain it.\n     */\n\n  }, {\n    key: \"addValue\",\n    value: function addValue() {\n      this.addNewValue();\n      this.redraw();\n      this.checkConditions();\n\n      if (!this.isEmpty(this.dataValue)) {\n        this.restoreValue();\n      }\n\n      if (this.root) {\n        this.root.onChange();\n      }\n    }\n  }]);\n\n  return Multivalue;\n}(_Field2.default);\n\nexports.default = Multivalue;"]},"metadata":{},"sourceType":"script"}