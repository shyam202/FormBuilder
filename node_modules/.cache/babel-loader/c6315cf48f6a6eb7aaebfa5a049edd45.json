{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _WebformBuilder2 = _interopRequireDefault(require(\"./WebformBuilder\"));\n\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"./utils/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar WizardBuilder = /*#__PURE__*/function (_WebformBuilder) {\n  _inherits(WizardBuilder, _WebformBuilder);\n\n  var _super = _createSuper(WizardBuilder);\n\n  function WizardBuilder() {\n    var _this;\n\n    _classCallCheck(this, WizardBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n\n    options.skipInit = false;\n    _this = _super.call(this, element, options);\n    _this._form = {\n      components: [_this.getPageConfig(1)]\n    };\n    _this.page = 0; // Need to create a component order for each group.\n\n    var _loop = function _loop(group) {\n      if (_this.groups[group] && _this.groups[group].components) {\n        _this.groups[group].componentOrder = Object.keys(_this.groups[group].components).map(function (key) {\n          return _this.groups[group].components[key];\n        }).filter(function (component) {\n          return component && !component.ignore;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return component.key;\n        });\n      }\n    };\n\n    for (var group in _this.groups) {\n      _loop(group);\n    }\n\n    _this.options.hooks.attachPanel = function (element, component) {\n      if (component.refs.removeComponent) {\n        _this.addEventListener(component.refs.removeComponent, 'click', function () {\n          var pageIndex = _this.pages.findIndex(function (page) {\n            return page.key === component.key;\n          });\n\n          var componentIndex = _this._form.components.findIndex(function (comp) {\n            return comp.key === component.key;\n          });\n\n          if (pageIndex !== -1) {\n            _this.removePage(pageIndex, componentIndex);\n          }\n        });\n      }\n    };\n\n    var originalRenderComponentsHook = _this.options.hooks.renderComponents;\n\n    _this.options.hooks.renderComponents = function (html, _ref) {\n      var components = _ref.components,\n          self = _ref.self;\n\n      if (self.type === 'form' && !self.root) {\n        return html;\n      } else {\n        return originalRenderComponentsHook(html, {\n          components: components,\n          self: self\n        });\n      }\n    };\n\n    var originalAttachComponentsHook = _this.options.hooks.attachComponents;\n\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      if (component.type === 'form' && !component.root) {\n        return element;\n      }\n\n      return originalAttachComponentsHook(element, components, container, component);\n    }; // Wizard pages don't replace themselves in the right array. Do that here.\n\n\n    _this.on('saveComponent', function (component, originalComponent) {\n      var webformComponents = _this.webform.components.map(function (_ref2) {\n        var component = _ref2.component;\n        return component;\n      });\n\n      if (_this._form.components.includes(originalComponent)) {\n        _this._form.components[_this._form.components.indexOf(originalComponent)] = component;\n\n        _this.rebuild();\n      } else if (webformComponents.includes(originalComponent)) {\n        _this._form.components.push(component);\n\n        _this.rebuild();\n      } else {\n        // Fallback to look for panel based on key.\n        var formComponentIndex = _this._form.components.findIndex(function (comp) {\n          return originalComponent.key === comp.key;\n        });\n\n        if (formComponentIndex !== -1) {\n          _this._form.components[formComponentIndex] = component;\n\n          _this.rebuild();\n        }\n      }\n    }, true);\n\n    return _this;\n  }\n\n  _createClass(WizardBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop(element) {\n      return this.webform && this.webform.refs && this.webform.refs.webform === element ? false : true;\n    }\n  }, {\n    key: \"pages\",\n    get: function get() {\n      return _lodash.default.filter(this._form.components, {\n        type: 'panel'\n      });\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      var pages = this.pages;\n      return pages && pages.length >= this.page ? pages[this.page] : null;\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this._form;\n    },\n    set: function set(value) {\n      this._form = value;\n\n      if (!this._form.components || !Array.isArray(this._form.components)) {\n        this._form.components = [];\n      }\n\n      if (this.pages.length === 0) {\n        var components = this._form.components.filter(function (component) {\n          return component.type !== 'button';\n        });\n\n        this._form.components = [this.getPageConfig(1, components)];\n      }\n\n      this.rebuild();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      _lodash.default.assign(this.currentPage, this.webform._form.components[0]);\n\n      var webform = new _Webform.default(this.options);\n      webform.setForm(this._form, {\n        noEmit: true\n      });\n      return webform.schema;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return this.renderTemplate('builderWizard', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this2.renderTemplate('builderSidebarGroup', {\n              group: _this2.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this2.id),\n              subgroups: _this2.groups[groupKey].subgroups.map(function (group) {\n                return _this2.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        pages: this.pages,\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this3 = this;\n\n      this.loadRefs(element, {\n        addPage: 'multiple',\n        gotoPage: 'multiple'\n      });\n      this.refs.addPage.forEach(function (link) {\n        _this3.addEventListener(link, 'click', function (event) {\n          event.preventDefault();\n\n          _this3.addPage();\n        });\n      });\n      this.refs.gotoPage.forEach(function (link, index) {\n        _this3.addEventListener(link, 'click', function (event) {\n          event.preventDefault();\n\n          _this3.setPage(index);\n        });\n      });\n      return _get(_getPrototypeOf(WizardBuilder.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"rebuild\",\n    value: function rebuild() {\n      var page = this.currentPage;\n      this.webform.setForm({\n        display: 'form',\n        type: 'form',\n        components: page ? [page] : []\n      }, {\n        keepAsReference: true\n      });\n      return this.redraw();\n    }\n  }, {\n    key: \"addPage\",\n    value: function addPage(page) {\n      var newPage = page && page.schema ? (0, _utils.fastCloneDeep)(page.schema) : this.getPageConfig(this.pages.length + 1);\n\n      _builder.default.uniquify(this._form.components, newPage);\n\n      this._form.components.push(newPage);\n\n      this.emitSaveComponentEvent(newPage, newPage, this._form, 'components', this._form.components.length - 1, true, newPage);\n      this.emit('change', this._form);\n      return this.rebuild();\n    }\n  }, {\n    key: \"removePage\",\n    value: function removePage(pageIndex, componentIndex) {\n      this._form.components.splice(componentIndex, 1);\n\n      this.emit('change', this._form);\n\n      if (pageIndex === this.pages.length) {\n        // If the last page is removed.\n        if (pageIndex === 0) {\n          this._form.components.push(this.getPageConfig(1));\n\n          return this.rebuild();\n        } else {\n          return this.setPage(pageIndex - 1);\n        }\n      } else {\n        return this.rebuild();\n      }\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(index) {\n      if (index === this.page) {\n        return;\n      }\n\n      this.page = index;\n      return this.rebuild();\n    }\n  }, {\n    key: \"getPageConfig\",\n    value: function getPageConfig(index) {\n      var components = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      return {\n        title: \"Page \".concat(index),\n        label: \"Page \".concat(index),\n        type: 'panel',\n        key: \"page\".concat(index),\n        components: components\n      };\n    }\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (component instanceof WizardBuilder) {\n        return;\n      }\n\n      if (this._form.components.find(function (comp) {\n        return _lodash.default.isEqual(component.component, comp);\n      })) {\n        this.addPage(component);\n      } else {\n        return _get(_getPrototypeOf(WizardBuilder.prototype), \"pasteComponent\", this).call(this, component);\n      }\n    }\n  }]);\n\n  return WizardBuilder;\n}(_WebformBuilder2.default);\n\nexports.default = WizardBuilder;","map":{"version":3,"sources":["C:/Users/ShyamLakhani/Desktop/my-app/node_modules/formiojs/WizardBuilder.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_WebformBuilder2","_interopRequireDefault","require","_Webform","_builder","_lodash","_utils","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","call","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","WizardBuilder","_WebformBuilder","_super","_this","element","options","HTMLElement","skipInit","_form","components","getPageConfig","page","_loop","group","groups","componentOrder","keys","map","filter","component","ignore","sort","a","b","weight","hooks","attachPanel","refs","removeComponent","addEventListener","pageIndex","pages","findIndex","componentIndex","comp","removePage","originalRenderComponentsHook","renderComponents","html","_ref","type","root","originalAttachComponentsHook","attachComponents","container","on","originalComponent","webformComponents","webform","_ref2","includes","indexOf","rebuild","push","formComponentIndex","allowDrop","set","Array","isArray","assign","currentPage","setForm","noEmit","schema","render","_this2","renderTemplate","sidebar","scrollEnabled","sideBarScroll","groupOrder","groupId","concat","id","groupKey","subgroups","form","attach","_this3","loadRefs","addPage","gotoPage","forEach","link","event","preventDefault","index","setPage","display","keepAsReference","redraw","newPage","fastCloneDeep","uniquify","emitSaveComponentEvent","emit","splice","undefined","title","label","pasteComponent","find","isEqual"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.sort.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _WebformBuilder2 = _interopRequireDefault(require(\"./WebformBuilder\"));\n\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"./utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar WizardBuilder = /*#__PURE__*/function (_WebformBuilder) {\n  _inherits(WizardBuilder, _WebformBuilder);\n\n  var _super = _createSuper(WizardBuilder);\n\n  function WizardBuilder() {\n    var _this;\n\n    _classCallCheck(this, WizardBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n\n    options.skipInit = false;\n    _this = _super.call(this, element, options);\n    _this._form = {\n      components: [_this.getPageConfig(1)]\n    };\n    _this.page = 0; // Need to create a component order for each group.\n\n    var _loop = function _loop(group) {\n      if (_this.groups[group] && _this.groups[group].components) {\n        _this.groups[group].componentOrder = Object.keys(_this.groups[group].components).map(function (key) {\n          return _this.groups[group].components[key];\n        }).filter(function (component) {\n          return component && !component.ignore;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return component.key;\n        });\n      }\n    };\n\n    for (var group in _this.groups) {\n      _loop(group);\n    }\n\n    _this.options.hooks.attachPanel = function (element, component) {\n      if (component.refs.removeComponent) {\n        _this.addEventListener(component.refs.removeComponent, 'click', function () {\n          var pageIndex = _this.pages.findIndex(function (page) {\n            return page.key === component.key;\n          });\n\n          var componentIndex = _this._form.components.findIndex(function (comp) {\n            return comp.key === component.key;\n          });\n\n          if (pageIndex !== -1) {\n            _this.removePage(pageIndex, componentIndex);\n          }\n        });\n      }\n    };\n\n    var originalRenderComponentsHook = _this.options.hooks.renderComponents;\n\n    _this.options.hooks.renderComponents = function (html, _ref) {\n      var components = _ref.components,\n          self = _ref.self;\n\n      if (self.type === 'form' && !self.root) {\n        return html;\n      } else {\n        return originalRenderComponentsHook(html, {\n          components: components,\n          self: self\n        });\n      }\n    };\n\n    var originalAttachComponentsHook = _this.options.hooks.attachComponents;\n\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      if (component.type === 'form' && !component.root) {\n        return element;\n      }\n\n      return originalAttachComponentsHook(element, components, container, component);\n    }; // Wizard pages don't replace themselves in the right array. Do that here.\n\n\n    _this.on('saveComponent', function (component, originalComponent) {\n      var webformComponents = _this.webform.components.map(function (_ref2) {\n        var component = _ref2.component;\n        return component;\n      });\n\n      if (_this._form.components.includes(originalComponent)) {\n        _this._form.components[_this._form.components.indexOf(originalComponent)] = component;\n\n        _this.rebuild();\n      } else if (webformComponents.includes(originalComponent)) {\n        _this._form.components.push(component);\n\n        _this.rebuild();\n      } else {\n        // Fallback to look for panel based on key.\n        var formComponentIndex = _this._form.components.findIndex(function (comp) {\n          return originalComponent.key === comp.key;\n        });\n\n        if (formComponentIndex !== -1) {\n          _this._form.components[formComponentIndex] = component;\n\n          _this.rebuild();\n        }\n      }\n    }, true);\n\n    return _this;\n  }\n\n  _createClass(WizardBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop(element) {\n      return this.webform && this.webform.refs && this.webform.refs.webform === element ? false : true;\n    }\n  }, {\n    key: \"pages\",\n    get: function get() {\n      return _lodash.default.filter(this._form.components, {\n        type: 'panel'\n      });\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      var pages = this.pages;\n      return pages && pages.length >= this.page ? pages[this.page] : null;\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this._form;\n    },\n    set: function set(value) {\n      this._form = value;\n\n      if (!this._form.components || !Array.isArray(this._form.components)) {\n        this._form.components = [];\n      }\n\n      if (this.pages.length === 0) {\n        var components = this._form.components.filter(function (component) {\n          return component.type !== 'button';\n        });\n\n        this._form.components = [this.getPageConfig(1, components)];\n      }\n\n      this.rebuild();\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      _lodash.default.assign(this.currentPage, this.webform._form.components[0]);\n\n      var webform = new _Webform.default(this.options);\n      webform.setForm(this._form, {\n        noEmit: true\n      });\n      return webform.schema;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return this.renderTemplate('builderWizard', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this2.renderTemplate('builderSidebarGroup', {\n              group: _this2.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this2.id),\n              subgroups: _this2.groups[groupKey].subgroups.map(function (group) {\n                return _this2.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        pages: this.pages,\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this3 = this;\n\n      this.loadRefs(element, {\n        addPage: 'multiple',\n        gotoPage: 'multiple'\n      });\n      this.refs.addPage.forEach(function (link) {\n        _this3.addEventListener(link, 'click', function (event) {\n          event.preventDefault();\n\n          _this3.addPage();\n        });\n      });\n      this.refs.gotoPage.forEach(function (link, index) {\n        _this3.addEventListener(link, 'click', function (event) {\n          event.preventDefault();\n\n          _this3.setPage(index);\n        });\n      });\n      return _get(_getPrototypeOf(WizardBuilder.prototype), \"attach\", this).call(this, element);\n    }\n  }, {\n    key: \"rebuild\",\n    value: function rebuild() {\n      var page = this.currentPage;\n      this.webform.setForm({\n        display: 'form',\n        type: 'form',\n        components: page ? [page] : []\n      }, {\n        keepAsReference: true\n      });\n      return this.redraw();\n    }\n  }, {\n    key: \"addPage\",\n    value: function addPage(page) {\n      var newPage = page && page.schema ? (0, _utils.fastCloneDeep)(page.schema) : this.getPageConfig(this.pages.length + 1);\n\n      _builder.default.uniquify(this._form.components, newPage);\n\n      this._form.components.push(newPage);\n\n      this.emitSaveComponentEvent(newPage, newPage, this._form, 'components', this._form.components.length - 1, true, newPage);\n      this.emit('change', this._form);\n      return this.rebuild();\n    }\n  }, {\n    key: \"removePage\",\n    value: function removePage(pageIndex, componentIndex) {\n      this._form.components.splice(componentIndex, 1);\n\n      this.emit('change', this._form);\n\n      if (pageIndex === this.pages.length) {\n        // If the last page is removed.\n        if (pageIndex === 0) {\n          this._form.components.push(this.getPageConfig(1));\n\n          return this.rebuild();\n        } else {\n          return this.setPage(pageIndex - 1);\n        }\n      } else {\n        return this.rebuild();\n      }\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(index) {\n      if (index === this.page) {\n        return;\n      }\n\n      this.page = index;\n      return this.rebuild();\n    }\n  }, {\n    key: \"getPageConfig\",\n    value: function getPageConfig(index) {\n      var components = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      return {\n        title: \"Page \".concat(index),\n        label: \"Page \".concat(index),\n        type: 'panel',\n        key: \"page\".concat(index),\n        components: components\n      };\n    }\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (component instanceof WizardBuilder) {\n        return;\n      }\n\n      if (this._form.components.find(function (comp) {\n        return _lodash.default.isEqual(component.component, comp);\n      })) {\n        this.addPage(component);\n      } else {\n        return _get(_getPrototypeOf(WizardBuilder.prototype), \"pasteComponent\", this).call(this, component);\n      }\n    }\n  }]);\n\n  return WizardBuilder;\n}(_WebformBuilder2.default);\n\nexports.default = WizardBuilder;"]},"metadata":{},"sourceType":"script"}